
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>shapepipe.pipeline.file_handler &#8212; ShapePipe v0.0</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet">
  <link href="../../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-book-theme.css?digest=84ace793992934648b4de8eed757e5a2" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx-book-theme.9d8b4a8b9bb19db25eeaddc40d639ba2.js"></script>
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<div class="col-12 col-md-3 bd-sidebar site-navigation " id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">ShapePipe v0.0</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  About ShapePipe
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../about.html">
   About
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../contributors.html">
   Contributors
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Installing ShapePipe
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../dependencies.html">
   Dependencies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../installation.html">
   Installation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Running ShapePipe
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../basic_execution.html">
   Basic Execution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../configuration.html">
   Configuration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../testing.html">
   Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../pipeline_tutorial.html">
   ShapePipe Tutorial
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Miscellaneous
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../post_processing.html">
   Post-processing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../random_cat.html">
   Create random catalogue
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  API Documentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../shapepipe.html">
   shapepipe
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../shapepipe.modules.html">
     shapepipe.modules
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.find_exposures_package.html">
       shapepipe.modules.find_exposures_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
      <label for="toctree-checkbox-3">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.find_exposures_package.find_exposures.html">
         shapepipe.modules.find_exposures_package.find_exposures
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.get_images_package.html">
       shapepipe.modules.get_images_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
      <label for="toctree-checkbox-4">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.get_images_package.get_images.html">
         shapepipe.modules.get_images_package.get_images
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.make_cat_package.html">
       shapepipe.modules.make_cat_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
      <label for="toctree-checkbox-5">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.make_cat_package.make_cat.html">
         shapepipe.modules.make_cat_package.make_cat
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.mask_package.html">
       shapepipe.modules.mask_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
      <label for="toctree-checkbox-6">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.mask_package.mask.html">
         shapepipe.modules.mask_package.mask
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.match_external_package.html">
       shapepipe.modules.match_external_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
      <label for="toctree-checkbox-7">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.match_external_package.match_external.html">
         shapepipe.modules.match_external_package.match_external
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.mccd_package.html">
       shapepipe.modules.mccd_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
      <label for="toctree-checkbox-8">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.mccd_package.mccd_interpolation_script.html">
         shapepipe.modules.mccd_package.mccd_interpolation_script
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.mccd_package.mccd_plot_utilities.html">
         shapepipe.modules.mccd_package.mccd_plot_utilities
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.mccd_package.shapepipe_auxiliary_mccd.html">
         shapepipe.modules.mccd_package.shapepipe_auxiliary_mccd
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.merge_headers_package.html">
       shapepipe.modules.merge_headers_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
      <label for="toctree-checkbox-9">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.merge_headers_package.merge_headers.html">
         shapepipe.modules.merge_headers_package.merge_headers
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.merge_sep_cats_package.html">
       shapepipe.modules.merge_sep_cats_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
      <label for="toctree-checkbox-10">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.merge_sep_cats_package.merge_sep_cats.html">
         shapepipe.modules.merge_sep_cats_package.merge_sep_cats
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.merge_starcat_package.html">
       shapepipe.modules.merge_starcat_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
      <label for="toctree-checkbox-11">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.merge_starcat_package.merge_starcat.html">
         shapepipe.modules.merge_starcat_package.merge_starcat
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.ngmix_package.html">
       shapepipe.modules.ngmix_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
      <label for="toctree-checkbox-12">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.ngmix_package.ngmix.html">
         shapepipe.modules.ngmix_package.ngmix
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.pastecat_package.html">
       shapepipe.modules.pastecat_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
      <label for="toctree-checkbox-13">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.pastecat_package.pastecat.html">
         shapepipe.modules.pastecat_package.pastecat
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.psfex_interp_package.html">
       shapepipe.modules.psfex_interp_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
      <label for="toctree-checkbox-14">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.psfex_interp_package.psfex_interp.html">
         shapepipe.modules.psfex_interp_package.psfex_interp
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.psfex_package.html">
       shapepipe.modules.psfex_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
      <label for="toctree-checkbox-15">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.psfex_package.psfex_script.html">
         shapepipe.modules.psfex_package.psfex_script
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.python_example_package.html">
       shapepipe.modules.python_example_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
      <label for="toctree-checkbox-16">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.python_example_package.python_example.html">
         shapepipe.modules.python_example_package.python_example
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.random_cat_package.html">
       shapepipe.modules.random_cat_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
      <label for="toctree-checkbox-17">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.random_cat_package.random_cat.html">
         shapepipe.modules.random_cat_package.random_cat
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.setools_package.html">
       shapepipe.modules.setools_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
      <label for="toctree-checkbox-18">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.setools_package.setools.html">
         shapepipe.modules.setools_package.setools
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.sextractor_package.html">
       shapepipe.modules.sextractor_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
      <label for="toctree-checkbox-19">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.sextractor_package.sextractor_script.html">
         shapepipe.modules.sextractor_package.sextractor_script
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.split_exp_package.html">
       shapepipe.modules.split_exp_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
      <label for="toctree-checkbox-20">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.split_exp_package.split_exp.html">
         shapepipe.modules.split_exp_package.split_exp
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.spread_model_package.html">
       shapepipe.modules.spread_model_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
      <label for="toctree-checkbox-21">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.spread_model_package.spread_model.html">
         shapepipe.modules.spread_model_package.spread_model
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.uncompress_fits_package.html">
       shapepipe.modules.uncompress_fits_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
      <label for="toctree-checkbox-22">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.uncompress_fits_package.uncompress_fits.html">
         shapepipe.modules.uncompress_fits_package.uncompress_fits
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.vignetmaker_package.html">
       shapepipe.modules.vignetmaker_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
      <label for="toctree-checkbox-23">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.vignetmaker_package.vignetmaker.html">
         shapepipe.modules.vignetmaker_package.vignetmaker
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.modules.module_decorator.html">
       shapepipe.modules.module_decorator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.modules.module_runners.html">
       shapepipe.modules.module_runners
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../shapepipe.pipeline.html">
     shapepipe.pipeline
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/>
    <label for="toctree-checkbox-24">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.pipeline.args.html">
       shapepipe.pipeline.args
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.pipeline.config.html">
       shapepipe.pipeline.config
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.pipeline.dependency_handler.html">
       shapepipe.pipeline.dependency_handler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.pipeline.execute.html">
       shapepipe.pipeline.execute
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.pipeline.file_handler.html">
       shapepipe.pipeline.file_handler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.pipeline.file_io.html">
       shapepipe.pipeline.file_io
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.pipeline.job_handler.html">
       shapepipe.pipeline.job_handler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.pipeline.mpi_run.html">
       shapepipe.pipeline.mpi_run
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.pipeline.run_log.html">
       shapepipe.pipeline.run_log
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.pipeline.shared.html">
       shapepipe.pipeline.shared
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.pipeline.str_handler.html">
       shapepipe.pipeline.str_handler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.pipeline.timeout.html">
       shapepipe.pipeline.timeout
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.pipeline.worker_handler.html">
       shapepipe.pipeline.worker_handler
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../shapepipe.utilities.html">
     shapepipe.utilities
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/>
    <label for="toctree-checkbox-25">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.utilities.canfar.html">
       shapepipe.utilities.canfar
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.utilities.cfis.html">
       shapepipe.utilities.cfis
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.utilities.file_system.html">
       shapepipe.utilities.file_system
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.utilities.galaxy.html">
       shapepipe.utilities.galaxy
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../shapepipe.info.html">
     shapepipe.info
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../shapepipe.run.html">
     shapepipe.run
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contributing to ShapePipe
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../contributing.html">
   Contribution Guidelines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../module_develop.html">
   Module Development
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../module_example.html">
   Module Examples
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  References
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../z_ref.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<!-- This is an invisible pixel that we watch to see if we've scrolled. -->
<div class="sbt-scroll-pixel-helper"></div>
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            <div class="topbar-left">
                
                <label class="nav-toggle-button" for="__navigation">
                    <div class="visually-hidden">Toggle navigation</div>
                    <i class="fas fa-bars"></i>
                </label>
                
            </div>
            
            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/CosmoStat/shapepipe"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/CosmoStat/shapepipe/issues/new?title=Issue%20on%20page%20%2F_modules/shapepipe/pipeline/file_handler.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1></h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            
              <div>
                
  <h1>Source code for shapepipe.pipeline.file_handler</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;FILE HANDLER.</span>

<span class="sd">This module defines a class for handling pipeline files.</span>

<span class="sd">:Author: Samuel Farrens &lt;samuel.farrens@cea.fr&gt;</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span><span class="p">,</span> <span class="n">reduce</span>
<span class="kn">from</span> <span class="nn">shutil</span> <span class="kn">import</span> <span class="n">copyfile</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">shapepipe.modules.module_runners</span> <span class="kn">import</span> <span class="n">get_module_runners</span>
<span class="kn">from</span> <span class="nn">shapepipe.pipeline.run_log</span> <span class="kn">import</span> <span class="n">RunLog</span><span class="p">,</span> <span class="n">get_list</span><span class="p">,</span> <span class="n">get_all</span><span class="p">,</span> <span class="n">get_last</span>
<span class="kn">from</span> <span class="nn">shapepipe.pipeline</span> <span class="kn">import</span> <span class="n">shared</span>
<span class="kn">from</span> <span class="nn">shapepipe.utilities.file_system</span> <span class="kn">import</span> <span class="n">mkdir</span>


<div class="viewcode-block" id="FileHandler"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler">[docs]</a><span class="k">class</span> <span class="nc">FileHandler</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;File Handler.</span>

<span class="sd">    This class manages the files used and produced during a pipeline run.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    run_name : str</span>
<span class="sd">        Run name</span>
<span class="sd">    module_list : list</span>
<span class="sd">        List of modules to be run</span>
<span class="sd">    config : CustomParser</span>
<span class="sd">        Configuaration parser instance</span>
<span class="sd">    verbose : bool, optional</span>
<span class="sd">        Verbose setting, default is True</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_name</span><span class="p">,</span> <span class="n">modules</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_run_name</span> <span class="o">=</span> <span class="n">run_name</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_module_list</span> <span class="o">=</span> <span class="n">modules</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid module list, check for a trailing comma&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_verbose</span> <span class="o">=</span> <span class="n">verbose</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">module_runners</span> <span class="o">=</span> <span class="n">get_module_runners</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_module_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_input_list</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="s1">&#39;FILE&#39;</span><span class="p">,</span> <span class="s1">&#39;INPUT_DIR&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_output_dir</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">getexpanded</span><span class="p">(</span><span class="s1">&#39;FILE&#39;</span><span class="p">,</span> <span class="s1">&#39;OUTPUT_DIR&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_name</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FILE&#39;</span><span class="p">,</span> <span class="s1">&#39;LOG_NAME&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_correct_pattern</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">getboolean</span><span class="p">(</span>
            <span class="s1">&#39;FILE&#39;</span><span class="p">,</span>
            <span class="s1">&#39;CORRECT_FILE_PATTERN&#39;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_log_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setpath</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_output_dir</span><span class="p">,</span>
            <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FILE&#39;</span><span class="p">,</span> <span class="s1">&#39;RUN_LOG_NAME&#39;</span><span class="p">),</span>
            <span class="s1">&#39;.txt&#39;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="s1">&#39;FILE&#39;</span><span class="p">,</span> <span class="s1">&#39;FILE_PATTERN&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_file_pattern</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="s1">&#39;FILE&#39;</span><span class="p">,</span> <span class="s1">&#39;FILE_PATTERN&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="s1">&#39;FILE&#39;</span><span class="p">,</span> <span class="s1">&#39;FILE_EXT&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_file_ext</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="s1">&#39;FILE&#39;</span><span class="p">,</span> <span class="s1">&#39;FILE_EXT&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="s1">&#39;FILE&#39;</span><span class="p">,</span> <span class="s1">&#39;NUMBERING_SCHEME&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_numbering_scheme</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FILE&#39;</span><span class="p">,</span> <span class="s1">&#39;NUMBERING_SCHEME&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_numbering_scheme</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;RE:\_\d+&#39;</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="s1">&#39;FILE&#39;</span><span class="p">,</span> <span class="s1">&#39;NUMBER_LIST&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FILE&#39;</span><span class="p">,</span> <span class="s1">&#39;NUMBER_LIST&#39;</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_number_list</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">read_number_list</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FILE&#39;</span><span class="p">,</span> <span class="s1">&#39;NUMBER_LIST&#39;</span><span class="p">))</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_number_list</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="s1">&#39;FILE&#39;</span><span class="p">,</span> <span class="s1">&#39;NUMBER_LIST&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_number_list</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">run_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run Directory.</span>

<span class="sd">        This method defines the run directory.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_dir</span>

    <span class="nd">@run_dir</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">run_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_run_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_dir</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">check_exists</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_input_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Input Directory.</span>

<span class="sd">        This method defines the input directories.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__input_dir</span>

    <span class="nd">@_input_dir</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">_input_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__input_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_dirs</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_output_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Output Directory.</span>

<span class="sd">        This method defines the output directory.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__output_dir</span>

    <span class="nd">@_output_dir</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">_output_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__output_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_dir</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="FileHandler.read_number_list"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler.read_number_list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">read_number_list</span><span class="p">(</span><span class="n">file_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read Number List.</span>

<span class="sd">        Extract number strings to be processed from a file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        file_name : str</span>
<span class="sd">            Number list file name</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span> <span class="k">as</span> <span class="n">data_file</span><span class="p">:</span>
            <span class="n">number_list</span> <span class="o">=</span> <span class="n">data_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">value</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">number_list</span><span class="p">]</span></div>

<div class="viewcode-block" id="FileHandler.check_dir"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler.check_dir">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">check_dir</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dir_name</span><span class="p">,</span> <span class="n">check_exists</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check Directory.</span>

<span class="sd">        Raise error if directory exists.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dir_name : str</span>
<span class="sd">            Directory name</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        OSError</span>
<span class="sd">            If directory already exists</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">check_exists</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">dir_name</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">OSError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Directory </span><span class="si">{</span><span class="n">dir_name</span><span class="si">}</span><span class="s1"> already exists.&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">strip_slash</span><span class="p">(</span><span class="n">dir_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="FileHandler.check_dirs"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler.check_dirs">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">check_dirs</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dir_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check Directories.</span>

<span class="sd">        Check directories in list</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dir_list : list</span>
<span class="sd">            Directory list</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">cls</span><span class="o">.</span><span class="n">check_dir</span><span class="p">(</span><span class="nb">dir</span><span class="p">)</span> <span class="k">for</span> <span class="nb">dir</span> <span class="ow">in</span> <span class="n">dir_list</span><span class="p">]</span></div>

<div class="viewcode-block" id="FileHandler.mkdir"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler.mkdir">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">mkdir</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dir_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Make Directory.</span>

<span class="sd">        This method creates a directory at the specified path.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dir_name : str`</span>
<span class="sd">            Directory name with full path</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">check_dir</span><span class="p">(</span><span class="n">dir_name</span><span class="p">,</span> <span class="n">check_exists</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">mkdir</span><span class="p">(</span><span class="n">dir_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="FileHandler.setpath"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler.setpath">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">setpath</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Path Name.</span>

<span class="sd">        This method appends the file/directory name to the input path.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : str</span>
<span class="sd">            Full path</span>
<span class="sd">        name : str</span>
<span class="sd">            File or directory name</span>
<span class="sd">        ext : str, optional</span>
<span class="sd">            File extension, default is &#39;&#39;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            Formated path</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">name</span><span class="si">}{</span><span class="n">ext</span><span class="si">}</span><span class="s1">&#39;</span></div>

<div class="viewcode-block" id="FileHandler.strip_slash"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler.strip_slash">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">strip_slash</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Strip Slash.</span>

<span class="sd">        This method removes the trailing slash from a path.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : str</span>
<span class="sd">            Full path</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            Updated path</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">path</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="FileHandler.strip_slash_list"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler.strip_slash_list">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">strip_slash_list</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Strip Slash List.</span>

<span class="sd">        This method removes the trailing slash from a list of paths.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path_list : list</span>
<span class="sd">            List of paths</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            Updated paths</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">cls</span><span class="o">.</span><span class="n">strip_slash</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">path_list</span><span class="p">]</span></div>

<div class="viewcode-block" id="FileHandler.flatten_list"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler.flatten_list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">flatten_list</span><span class="p">(</span><span class="n">input_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Flatten List.</span>

<span class="sd">        Flatten a list of lists.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_list : list</span>
<span class="sd">            A list of lists</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            Flattened list</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">input_list</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span></div>

<div class="viewcode-block" id="FileHandler._get_module_run_name"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler._get_module_run_name">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_module_run_name</span><span class="p">(</span><span class="nb">dir</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Module Run Name.</span>

<span class="sd">        Retrieve module run name, module name and search string from input</span>
<span class="sd">        string.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dir : str</span>
<span class="sd">            Input directory string</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple</span>
<span class="sd">            Module run name, module name, search string</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">string</span><span class="p">,</span> <span class="n">module_run</span> <span class="o">=</span> <span class="nb">dir</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">module</span> <span class="o">=</span> <span class="n">module_run</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">module_run</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">module</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">string</span></div>

<div class="viewcode-block" id="FileHandler._check_input_dir_list"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler._check_input_dir_list">[docs]</a>    <span class="k">def</span> <span class="nf">_check_input_dir_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dir_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check Input Directory List.</span>

<span class="sd">        Check an input list to see if the directories exist or if the the run</span>
<span class="sd">        log should be serarched for an appropriate output directory.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dir_list : list</span>
<span class="sd">            List of directories</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            For invalid input directory value</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">input_dir</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="nb">dir</span> <span class="ow">in</span> <span class="n">dir_list</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="nb">dir</span><span class="p">):</span>
                <span class="n">input_dir</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dir</span><span class="p">)</span>

            <span class="k">elif</span> <span class="s1">&#39;last&#39;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="n">module_run</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_module_run_name</span><span class="p">(</span><span class="nb">dir</span><span class="p">)</span>
                <span class="n">runs</span> <span class="o">=</span> <span class="n">get_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_run_log_file</span><span class="p">)</span>
                <span class="n">last_module</span> <span class="o">=</span> <span class="n">get_last</span><span class="p">(</span><span class="n">runs</span><span class="p">,</span> <span class="n">module</span><span class="p">)</span>
                <span class="n">input_dir</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setpath</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">setpath</span><span class="p">(</span><span class="n">last_module</span><span class="p">,</span> <span class="n">module_run</span><span class="p">),</span>
                        <span class="s1">&#39;output&#39;</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>

            <span class="k">elif</span> <span class="s1">&#39;all&#39;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="n">module_run</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_module_run_name</span><span class="p">(</span><span class="nb">dir</span><span class="p">)</span>
                <span class="n">runs</span> <span class="o">=</span> <span class="n">get_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_run_log_file</span><span class="p">)</span>
                <span class="n">all_runs</span> <span class="o">=</span> <span class="n">get_all</span><span class="p">(</span><span class="n">runs</span><span class="p">,</span> <span class="n">module</span><span class="p">)</span>
                <span class="n">input_dir</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setpath</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">setpath</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">module_run</span><span class="p">),</span>
                        <span class="s1">&#39;output&#39;</span>
                    <span class="p">)</span>
                    <span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="n">all_runs</span>
                <span class="p">])</span>

            <span class="k">elif</span> <span class="s1">&#39;:&#39;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="n">module_run</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_module_run_name</span><span class="p">(</span><span class="nb">dir</span><span class="p">)</span>
                <span class="n">input_dir</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">setpath</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">setpath</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_run_log</span><span class="o">.</span><span class="n">get_run</span><span class="p">(</span><span class="n">string</span><span class="p">),</span>
                            <span class="n">module_run</span><span class="p">,</span>
                        <span class="p">),</span>
                        <span class="s1">&#39;output&#39;</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;Invalid INPUT_DIR (</span><span class="si">{</span><span class="nb">dir</span><span class="si">}</span><span class="s1">). Make sure the paths &#39;</span>
                    <span class="o">+</span> <span class="s1">&#39;provided are valid directories or use the &#39;</span>
                    <span class="o">+</span> <span class="s1">&#39;allowed special keys.&#39;</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">input_dir</span></div>

<div class="viewcode-block" id="FileHandler._get_input_dir"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler._get_input_dir">[docs]</a>    <span class="k">def</span> <span class="nf">_get_input_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Input Directory.</span>

<span class="sd">        This method sets the module input directory</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_input_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_input_dir_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_list</span><span class="p">)</span></div>

<div class="viewcode-block" id="FileHandler.create_global_run_dirs"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler.create_global_run_dirs">[docs]</a>    <span class="k">def</span> <span class="nf">create_global_run_dirs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create Global Run Directories.</span>

<span class="sd">        This method creates the pipeline output directories for a given run.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setpath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_output_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setpath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">run_dir</span><span class="p">,</span> <span class="s1">&#39;logs&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tmp_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setpath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">run_dir</span><span class="p">,</span> <span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setpath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_log_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_log</span> <span class="o">=</span> <span class="n">RunLog</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_run_log_file</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_module_list</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_dir</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">run_dir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_log_dir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tmp_dir</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_get_input_dir</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_copy_config_to_log</span><span class="p">()</span></div>

<div class="viewcode-block" id="FileHandler._copy_config_to_log"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler._copy_config_to_log">[docs]</a>    <span class="k">def</span> <span class="nf">_copy_config_to_log</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Copy Config to Log.</span>

<span class="sd">        Copy configuration file to run log directory.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">config_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">file_name</span><span class="p">)</span>

        <span class="n">copyfile</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">file_name</span><span class="p">,</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_log_dir</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">config_file_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="FileHandler.get_module_current_run"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler.get_module_current_run">[docs]</a>    <span class="k">def</span> <span class="nf">get_module_current_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Module Current Run.</span>

<span class="sd">        Get the run current run count for the module.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        module : str</span>
<span class="sd">            Module name</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            Module run count</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="s1">&#39;run_count&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="FileHandler.get_module_run_prop"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler.get_module_run_prop">[docs]</a>    <span class="k">def</span> <span class="nf">get_module_run_prop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="nb">property</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Module Run Property.</span>

<span class="sd">        Return the requested property for a given module run.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        module : str</span>
<span class="sd">            Module name</span>
<span class="sd">        property : str</span>
<span class="sd">            Module run property name</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        any</span>
<span class="sd">            Module run property value</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            For invalid module dictionary key</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">run_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="s1">&#39;latest&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">property</span> <span class="o">==</span> <span class="s1">&#39;run_name&#39;</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">run_name</span>
        <span class="k">elif</span> <span class="nb">property</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="nb">property</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">property</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="nb">property</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;Property </span><span class="si">{</span><span class="nb">property</span><span class="si">}</span><span class="s1"> not found for module </span><span class="si">{</span><span class="n">module</span><span class="si">}</span><span class="s1">.&#39;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">value</span></div>

<div class="viewcode-block" id="FileHandler.get_module_config_sec"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler.get_module_config_sec">[docs]</a>    <span class="k">def</span> <span class="nf">get_module_config_sec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Module Configuration Section.</span>

<span class="sd">        Get the name of section name in the configuration file for the module.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        module : str</span>
<span class="sd">            Module name</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            Configuration file section name</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="s1">&#39;latest&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span></div>

<div class="viewcode-block" id="FileHandler.get_add_module_property"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler.get_add_module_property">[docs]</a>    <span class="k">def</span> <span class="nf">get_add_module_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_name</span><span class="p">,</span> <span class="nb">property</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Additional Module Properties.</span>

<span class="sd">        Get a list of additional module property values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        run_name : str</span>
<span class="sd">            Module run name</span>
<span class="sd">        property : str</span>
<span class="sd">            Property name</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            Additional module property values</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span>
            <span class="n">run_name</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span>
            <span class="sa">f</span><span class="s1">&#39;ADD_</span><span class="si">{</span><span class="nb">property</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="p">)):</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span>
                <span class="n">run_name</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span>
                <span class="sa">f</span><span class="s1">&#39;ADD_</span><span class="si">{</span><span class="nb">property</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="FileHandler._set_module_property"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler._set_module_property">[docs]</a>    <span class="k">def</span> <span class="nf">_set_module_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">run_name</span><span class="p">,</span> <span class="nb">property</span><span class="p">,</span> <span class="n">get_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Module Property.</span>

<span class="sd">        Set a module property from either the configuration file or the module</span>
<span class="sd">        runner.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        module : str</span>
<span class="sd">            Module name</span>
<span class="sd">        property : str</span>
<span class="sd">            Property name</span>
<span class="sd">        get_type : str</span>
<span class="sd">            Type of object to get from config file</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Module properties are set with the following hierarchy:</span>

<span class="sd">        1. Look for properties in module section of the config file,</span>
<span class="sd">        2. look for default properties in the file handler, which sources the</span>
<span class="sd">           ``[FILE]`` section of the config file,</span>
<span class="sd">        3. look for default properties in the module runner definition.</span>

<span class="sd">        In other words, module runner definitions will only be used if the</span>
<span class="sd">        properties are not set in the confg file. File handler properties will</span>
<span class="sd">        be used for all modules, overriding all module runner definitions.</span>
<span class="sd">        Module specific properties from the config file will override all other</span>
<span class="sd">        definitions, but only for the module in question.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 1) Check for parameter value in module section of config file</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="n">run_name</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="nb">property</span><span class="o">.</span><span class="n">upper</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">get_type</span> <span class="o">==</span> <span class="s1">&#39;str&#39;</span><span class="p">:</span>
                <span class="n">prop_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="n">run_name</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span>
                    <span class="nb">property</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">get_type</span> <span class="o">==</span> <span class="s1">&#39;list&#39;</span><span class="p">:</span>
                <span class="n">prop_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span>
                    <span class="n">run_name</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span>
                    <span class="nb">property</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">get_type</span><span class="si">}</span><span class="s1"> is not a valid get type&#39;</span><span class="p">)</span>

        <span class="c1"># 2) Check for default parameter values in file handler</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;_</span><span class="si">{</span><span class="nb">property</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">):</span>
            <span class="n">prop_val</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;_</span><span class="si">{</span><span class="nb">property</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># 3) Check for default parameter values in module runner</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module_runners</span><span class="p">[</span><span class="n">module</span><span class="p">],</span> <span class="nb">property</span><span class="p">):</span>
            <span class="n">prop_val</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module_runners</span><span class="p">[</span><span class="n">module</span><span class="p">],</span> <span class="nb">property</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;No value for </span><span class="si">{</span><span class="nb">property</span><span class="si">}</span><span class="s1"> in </span><span class="si">{</span><span class="n">module</span><span class="si">}</span><span class="s1"> could be found.&#39;</span>
            <span class="p">)</span>

        <span class="c1"># Look for additional module properties for list objects</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">prop_val</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_add_module_property</span><span class="p">(</span><span class="n">run_name</span><span class="p">,</span> <span class="nb">property</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">prop_val</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_add_module_property</span><span class="p">(</span><span class="n">run_name</span><span class="p">,</span> <span class="nb">property</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="nb">property</span><span class="p">]</span> <span class="o">=</span> <span class="n">prop_val</span></div>

<div class="viewcode-block" id="FileHandler._set_module_properties"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler._set_module_properties">[docs]</a>    <span class="k">def</span> <span class="nf">_set_module_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">run_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Module Properties.</span>

<span class="sd">        Get module properties defined in module runner wrapper.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        module : str</span>
<span class="sd">            Module name</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">module_props</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;numbering_scheme&#39;</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span>
            <span class="s1">&#39;run_method&#39;</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span>
            <span class="s1">&#39;input_module&#39;</span><span class="p">:</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span>
            <span class="s1">&#39;file_pattern&#39;</span><span class="p">:</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span>
            <span class="s1">&#39;file_ext&#39;</span><span class="p">:</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span>
            <span class="s1">&#39;depends&#39;</span><span class="p">:</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span>
            <span class="s1">&#39;executes&#39;</span><span class="p">:</span> <span class="s1">&#39;list&#39;</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="nb">property</span><span class="p">,</span> <span class="n">get_type</span> <span class="ow">in</span> <span class="n">module_props</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_module_property</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">run_name</span><span class="p">,</span> <span class="nb">property</span><span class="p">,</span> <span class="n">get_type</span><span class="p">)</span>

        <span class="c1"># Make sure the number of patterns and extensions match</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;file_ext&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
            <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;file_pattern&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;file_ext&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;file_ext&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;file_pattern&#39;</span><span class="p">]</span>
            <span class="p">]</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;file_ext&#39;</span><span class="p">])</span>
            <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;file_pattern&#39;</span><span class="p">])</span>
        <span class="p">):</span>
            <span class="n">n_fext</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;file_ext&#39;</span><span class="p">])</span>
            <span class="n">n_fpat</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;file_pattern&#39;</span><span class="p">])</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;The number of file_ext values (</span><span class="si">{</span><span class="n">n_fext</span><span class="si">}</span><span class="s1">) does not match the &#39;</span>
                <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;number of file_pattern values (</span><span class="si">{</span><span class="n">n_fpat</span><span class="si">}</span><span class="s1">).&#39;</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="FileHandler._create_module_run_dirs"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler._create_module_run_dirs">[docs]</a>    <span class="k">def</span> <span class="nf">_create_module_run_dirs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">run_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create Module Run Directories.</span>

<span class="sd">        This method creates the module output directories for a given run.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        module : str</span>
<span class="sd">            Module name</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;run_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setpath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_run_dir</span><span class="p">,</span> <span class="n">run_name</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;log_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setpath</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;run_dir&#39;</span><span class="p">],</span>
                <span class="s1">&#39;logs&#39;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;output_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setpath</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;run_dir&#39;</span><span class="p">],</span>
                <span class="s1">&#39;output&#39;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;run_dir&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;log_dir&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;output_dir&#39;</span><span class="p">])</span>

        <span class="c1"># Set current output directory to module output directory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;output_dir&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">module_run_dirs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;run&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_dir</span><span class="p">,</span>
            <span class="s1">&#39;log&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_dir</span><span class="p">,</span>
            <span class="s1">&#39;tmp&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tmp_dir</span><span class="p">,</span>
            <span class="s1">&#39;output&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span><span class="p">,</span>
            <span class="s1">&#39;run_log&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_log_file</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="FileHandler._set_module_input_dir"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler._set_module_input_dir">[docs]</a>    <span class="k">def</span> <span class="nf">_set_module_input_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">run_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Module Input Directory.</span>

<span class="sd">        Set the module input directory. If the module specified is the</span>
<span class="sd">        first module in the pipeline or does not have any input modules then</span>
<span class="sd">        only the ``INPUT_DIR`` from ``[FILE]`` is used, otherwise the output</span>
<span class="sd">        directory from the preceding module is used.</span>

<span class="sd">        Additional input directories can be specified with ``INPUT_DIR`` from</span>
<span class="sd">        ``[MODULE]``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        module : str</span>
<span class="sd">            Module name</span>
<span class="sd">        run_name : str</span>
<span class="sd">            Module run name, if the module has only been called once this will</span>
<span class="sd">            be identical to ``module``</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Create a default empty list of input directories</span>
        <span class="n">input_dir</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">dir_set_by</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Check if the module has no input modules or is the first module to</span>
        <span class="c1"># run in the pipeline</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;input_module&#39;</span><span class="p">],</span>
                <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="p">):</span>
            <span class="c1"># If so, use the input directory/ies set in the [FILE] section</span>
            <span class="n">input_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_dir</span>
            <span class="n">dir_set_by</span> <span class="o">=</span> <span class="s1">&#39;[FILE]&#39;</span>

        <span class="c1"># Check if input directory/ies has/have been set in the module config</span>
        <span class="c1"># section</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="n">run_name</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="s1">&#39;INPUT_DIR&#39;</span><span class="p">):</span>
            <span class="c1"># If so set this/these as the input directory/ies, note that this</span>
            <span class="c1"># overrides the value set in the [FILE] section</span>
            <span class="n">input_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_input_dir_list</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="n">run_name</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="s1">&#39;INPUT_DIR&#39;</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">dir_set_by</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;[</span><span class="si">{</span><span class="n">run_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s1">]&#39;</span>

        <span class="c1"># Check if input directory/ies has/have has not been set and if input</span>
        <span class="c1"># modules have been defined for the current module</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="ow">not</span> <span class="n">input_dir</span>
            <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;input_module&#39;</span><span class="p">],</span>
                <span class="nb">list</span>
            <span class="p">)</span>
        <span class="p">):</span>
            <span class="n">dir_set_by</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">module</span><span class="si">}</span><span class="s1">.py&#39;</span>
            <span class="c1"># If so, loop through all the input modules defined for the current</span>
            <span class="c1"># module</span>
            <span class="k">for</span> <span class="n">input_module</span> <span class="ow">in</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;input_module&#39;</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="c1"># Get the input module name and run</span>
                <span class="n">input_module</span><span class="p">,</span> <span class="n">in_mod_run</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">shared</span><span class="o">.</span><span class="n">split_module_run</span><span class="p">(</span><span class="n">input_module</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="c1"># Check if the input module was part of the current pipeline</span>
                <span class="k">if</span> <span class="n">input_module</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">:</span>
                    <span class="c1"># If so, check if the input module was a single run</span>
                    <span class="k">if</span> <span class="n">in_mod_run</span> <span class="o">==</span> <span class="n">input_module</span><span class="p">:</span>
                        <span class="c1"># If so, Set the input module run to the latest run</span>
                        <span class="n">in_mod_run</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">input_module</span><span class="p">][</span><span class="s1">&#39;latest&#39;</span><span class="p">]</span>
                    <span class="c1"># Add the output directory of the input module to</span>
                    <span class="c1"># the list of input directories for the current module</span>
                    <span class="n">input_dir</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">input_module</span><span class="p">][</span><span class="n">in_mod_run</span><span class="p">][</span>
                            <span class="s1">&#39;output_dir&#39;</span>
                        <span class="p">]</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># If not, add the last run of the input module to the</span>
                    <span class="c1"># list of input directories</span>
                    <span class="n">input_dir</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">input_module</span><span class="si">}</span><span class="s1">:last&#39;</span><span class="p">)</span>

        <span class="c1"># Check if input directory/ies has/have been added in the module config</span>
        <span class="c1"># section</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_add_module_property</span><span class="p">(</span><span class="n">run_name</span><span class="p">,</span> <span class="s1">&#39;input_dir&#39;</span><span class="p">):</span>
            <span class="c1"># If so add this/these to the input directory/ies</span>
            <span class="n">input_dir</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_add_module_property</span><span class="p">(</span><span class="n">run_name</span><span class="p">,</span> <span class="s1">&#39;input_dir&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">dir_set_by</span> <span class="o">==</span> <span class="sa">f</span><span class="s1">&#39;[</span><span class="si">{</span><span class="n">module</span><span class="si">}</span><span class="s1">]&#39;</span><span class="p">:</span>
                <span class="n">dir_set_by</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dir_set_by</span><span class="si">}</span><span class="s1"> and [</span><span class="si">{</span><span class="n">run_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s1">]&#39;</span>

        <span class="c1"># Check if no input directory has been set</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">input_dir</span><span class="p">:</span>
            <span class="c1"># If so, raise an error</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s1">&#39;Could not find appropriate input directory &#39;</span>
                <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;for module </span><span class="si">{</span><span class="n">run_name</span><span class="si">}</span><span class="s1">.&#39;</span>
            <span class="p">)</span>

        <span class="c1"># Add the input directories for the current module to the module</span>
        <span class="c1"># dictionary</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;input_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_dirs</span><span class="p">(</span><span class="n">input_dir</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;dir_set_by&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dir_set_by</span>

        <span class="c1"># Log the input directories and how they were set</span>
        <span class="n">module_input_dir</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39; -- Input directories: </span><span class="si">{</span><span class="n">input_dir</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">module_dir_set_by</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39; -- Inputs set by: </span><span class="si">{</span><span class="n">dir_set_by</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">module_input_dir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">module_dir_set_by</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">module_input_dir</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">module_dir_set_by</span><span class="p">)</span></div>

<div class="viewcode-block" id="FileHandler._generate_re_pattern"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler._generate_re_pattern">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_generate_re_pattern</span><span class="p">(</span><span class="n">match_pattern</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate Regular Expression Pattern.</span>

<span class="sd">        Generate a regular expression pattern from an input string.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        match_pattern : str</span>
<span class="sd">            Pattern string</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        _sre.SRE_Pattern</span>
<span class="sd">            Regular expression pattern</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        TypeError</span>
<span class="sd">            For invalid input type</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">match_pattern</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Match pattern must be a string.&#39;</span><span class="p">)</span>

        <span class="n">chars</span> <span class="o">=</span> <span class="p">[</span><span class="n">char</span> <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">match_pattern</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">char</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()]</span>
        <span class="n">split_pattern</span> <span class="o">=</span> <span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\.&#39;</span><span class="p">)</span>
        <span class="n">chars</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\\</span><span class="si">{</span><span class="n">char</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">chars</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
        <span class="n">num_length</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">d</span><span class="se">{{</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">digits</span><span class="p">)</span><span class="si">}</span><span class="se">}}</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">digits</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">split_pattern</span><span class="p">,</span> <span class="n">match_pattern</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">re_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">num_length</span><span class="p">,</span> <span class="n">chars</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">b</span><span class="p">]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">re_pattern</span><span class="p">)</span></div>

<div class="viewcode-block" id="FileHandler._strip_dir_from_file"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler._strip_dir_from_file">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_strip_dir_from_file</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dir_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Strip Directory from File Name.</span>

<span class="sd">        Remove the directory string from the file name.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        file_name : str</span>
<span class="sd">            File name</span>
<span class="sd">        dir_list : list</span>
<span class="sd">            Input directory list</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            File name</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">file_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">_dir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">_dir</span> <span class="ow">in</span> <span class="n">dir_list</span> <span class="k">if</span> <span class="n">_dir</span> <span class="ow">in</span> <span class="n">file_name</span>
        <span class="p">][</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="FileHandler._get_re"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler._get_re">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_get_re</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">num_scheme</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Regular Expression.</span>

<span class="sd">        Return the regular expression corresponding to the numbering scheme.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        num_scheme : str</span>
<span class="sd">            Numbering scheme</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            if num_scheme is None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            Regular Expression</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Raise an error if num_scheme is None,</span>
        <span class="c1"># but not if num_scheme==&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">num_scheme</span> <span class="ow">and</span> <span class="n">num_scheme</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>

            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No numbering scheme adapted&#39;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">num_scheme</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;RE:&#39;</span><span class="p">):</span>

            <span class="n">re_pattern</span> <span class="o">=</span> <span class="n">num_scheme</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;RE:&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="n">re_pattern</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_generate_re_pattern</span><span class="p">(</span><span class="n">num_scheme</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">re_pattern</span></div>

<div class="viewcode-block" id="FileHandler._save_num_patterns"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler._save_num_patterns">[docs]</a>    <span class="k">def</span> <span class="nf">_save_num_patterns</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dir_list</span><span class="p">,</span>
        <span class="n">re_pattern</span><span class="p">,</span>
        <span class="n">pattern</span><span class="p">,</span>
        <span class="n">ext</span><span class="p">,</span>
        <span class="n">output_file</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save Number Patterns.</span>

<span class="sd">        Save file number patterns to numpy binary, update file patterns and</span>
<span class="sd">        get correct file paths.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dir_list : list</span>
<span class="sd">            List of input directories</span>
<span class="sd">        re_pattern : str</span>
<span class="sd">            Regular expression pattern</span>
<span class="sd">        pattern : str</span>
<span class="sd">            File pattern</span>
<span class="sd">        ext : str</span>
<span class="sd">            File extension</span>
<span class="sd">        output_file : str</span>
<span class="sd">            Output file name</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Find all files matching the input pattern and extension from the</span>
        <span class="c1"># available input directories and identify the correct path</span>
        <span class="n">true_file_list</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">true_path</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">dir_list</span><span class="p">:</span>

            <span class="n">file_list</span> <span class="o">=</span> <span class="n">shared</span><span class="o">.</span><span class="n">find_files</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">ext</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">file_list</span><span class="p">:</span>
                <span class="n">true_file_list</span> <span class="o">=</span> <span class="n">file_list</span>
                <span class="n">true_path</span> <span class="o">=</span> <span class="n">path</span>
                <span class="k">del</span> <span class="n">file_list</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">true_file_list</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;No files found matching &quot;</span><span class="si">{</span><span class="n">pattern</span><span class="si">}</span><span class="s1">&quot; and &quot;</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s1">&quot; in the &#39;</span>
                <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;directories </span><span class="si">{</span><span class="n">dir_list</span><span class="si">}</span><span class="s1">.&#39;</span>
            <span class="p">)</span>

        <span class="c1"># Correct the extension if necessary</span>
        <span class="n">new_ext</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">ext</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">ext</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">ext</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_verbose</span> <span class="ow">and</span> <span class="n">new_ext</span> <span class="o">!=</span> <span class="n">ext</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Updating file extension from &quot;</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s1">&quot; to &quot;</span><span class="si">{</span><span class="n">new_ext</span><span class="si">}</span><span class="s1">&quot;.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">()</span>

        <span class="c1"># Select files matching the numbering scheme</span>
        <span class="n">final_file_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">found_match</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">correct_pattern</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_correct_pattern</span>
        <span class="n">new_pattern</span> <span class="o">=</span> <span class="n">pattern</span>

        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">true_file_list</span><span class="p">:</span>

            <span class="n">striped</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strip_dir_from_file</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">dir_list</span><span class="p">)</span>
            <span class="n">search_res</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">re_pattern</span><span class="p">,</span> <span class="n">striped</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">search_res</span><span class="p">:</span>
                <span class="n">file_name</span> <span class="o">=</span> <span class="n">search_res</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
                <span class="n">final_file_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
                <span class="n">found_match</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="c1"># Correct the pattern if necessary</span>
            <span class="k">if</span> <span class="n">found_match</span> <span class="ow">and</span> <span class="n">correct_pattern</span><span class="p">:</span>

                <span class="n">new_pattern</span> <span class="o">=</span> <span class="n">striped</span>

                <span class="k">for</span> <span class="n">substring</span> <span class="ow">in</span> <span class="p">(</span><span class="n">new_ext</span><span class="p">,</span> <span class="n">file_name</span><span class="p">):</span>
                    <span class="n">new_pattern</span> <span class="o">=</span> <span class="n">new_pattern</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">substring</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">new_pattern</span> <span class="o">!=</span> <span class="n">pattern</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s1">&#39;Updating pattern from &quot;</span><span class="si">{</span><span class="n">pattern</span><span class="si">}</span><span class="s1">&quot; to &#39;</span>
                        <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">new_pattern</span><span class="si">}</span><span class="s1">&quot;.&#39;</span>
                    <span class="p">)</span>
                    <span class="nb">print</span><span class="p">()</span>

                <span class="n">correct_pattern</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">found_match</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;Could not match numbering scheme &quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_numbering_scheme</span><span class="si">}</span><span class="s1">&quot; &#39;</span>
                <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;to any of the input files matching &quot;</span><span class="si">{</span><span class="n">pattern</span><span class="si">}</span><span class="s1">&quot; and &#39;</span>
                <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s1">&quot; in the directories </span><span class="si">{</span><span class="n">dir_list</span><span class="si">}</span><span class="s1">.&#39;</span>
            <span class="p">)</span>

        <span class="n">elem</span> <span class="o">=</span> <span class="n">shared</span><span class="o">.</span><span class="n">check_duplicate</span><span class="p">(</span><span class="n">final_file_list</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">elem</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s1">&#39;Input file list contains at least one duplicate element, &#39;</span>
                <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">elem</span><span class="si">}</span><span class="se">\&#39;</span><span class="s1"> that matches &#39;</span>
                <span class="o">+</span> <span class="s1">&#39;file pattern and numbering scheme, leading to identical &#39;</span>
                <span class="o">+</span> <span class="s1">&#39;input files.  Make sure that the correct input &#39;</span>
                <span class="o">+</span> <span class="s1">&#39;directory is used.&#39;</span>
            <span class="p">)</span>

        <span class="c1"># Save file list</span>
        <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">final_file_list</span><span class="p">))</span>

        <span class="k">del</span> <span class="n">true_file_list</span><span class="p">,</span> <span class="n">final_file_list</span>

        <span class="k">return</span> <span class="n">new_pattern</span><span class="p">,</span> <span class="n">new_ext</span><span class="p">,</span> <span class="n">true_path</span></div>

<div class="viewcode-block" id="FileHandler._save_match_patterns"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler._save_match_patterns">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_save_match_patterns</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="n">mmap_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save Match Patterns.</span>

<span class="sd">        Save matching number patterns to numpy binary.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        output_file : str</span>
<span class="sd">            Output file name</span>
<span class="sd">        mmap_list : list</span>
<span class="sd">            List of memory maps</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">num_pattern_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">mmap</span><span class="p">,</span> <span class="n">mmap_mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">mmap</span> <span class="ow">in</span> <span class="n">mmap_list</span><span class="p">]</span>

        <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
            <span class="n">output_file</span><span class="p">,</span>
            <span class="n">reduce</span><span class="p">(</span>
                <span class="n">partial</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">,</span> <span class="n">assume_unique</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                <span class="n">num_pattern_list</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="k">del</span> <span class="n">num_pattern_list</span></div>

<div class="viewcode-block" id="FileHandler._get_file_name"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler._get_file_name">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_file_name</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">ext</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get File Name.</span>

<span class="sd">        Get file name corresponding to the path, file pattern, number pattern</span>
<span class="sd">        and file extension.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : str</span>
<span class="sd">            Path to file</span>
<span class="sd">        pattern : str</span>
<span class="sd">            File pattern</span>
<span class="sd">        number : str</span>
<span class="sd">            Number pattern</span>
<span class="sd">        ext : str</span>
<span class="sd">            File extension</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            File name</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">pattern</span><span class="si">}{</span><span class="n">number</span><span class="si">}{</span><span class="n">ext</span><span class="si">}</span><span class="s1">&#39;</span></div>

<div class="viewcode-block" id="FileHandler._remove_mmaps"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler._remove_mmaps">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_remove_mmaps</span><span class="p">(</span><span class="n">mmap_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove Memory Maps.</span>

<span class="sd">        Remove memory map files in input list.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mmap_list : list or str</span>
<span class="sd">            List of memory map files</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mmap_list</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">mmap_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">mmap</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">mmap_list</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">mmap</span><span class="p">)</span></div>

<div class="viewcode-block" id="FileHandler._format_process_list"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler._format_process_list">[docs]</a>    <span class="k">def</span> <span class="nf">_format_process_list</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">patterns</span><span class="p">,</span>
        <span class="n">memory_map</span><span class="p">,</span>
        <span class="n">re_pattern</span><span class="p">,</span>
        <span class="n">num_scheme</span><span class="p">,</span>
        <span class="n">run_method</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Format Process List.</span>

<span class="sd">        Format the list of files to be processed.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        patterns : list</span>
<span class="sd">            List of file patterns</span>
<span class="sd">        memory_map : str</span>
<span class="sd">            Name of memory map file</span>
<span class="sd">        re_pattern : str</span>
<span class="sd">            Regular expression for numbering scheme</span>
<span class="sd">        num_scheme : str</span>
<span class="sd">            Numbering scheme</span>
<span class="sd">        run_method : str</span>
<span class="sd">            Run method</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            List of processes</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pattern_list</span><span class="p">,</span> <span class="n">ext_list</span><span class="p">,</span> <span class="n">path_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">patterns</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_list</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">number_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">memory_map</span><span class="p">,</span> <span class="n">mmap_mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">number_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_list</span>

        <span class="n">process_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">number_list</span><span class="p">:</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">re_pattern</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;The string &quot;</span><span class="si">{</span><span class="n">number</span><span class="si">}</span><span class="s1">&quot; does not match the &#39;</span>
                    <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;numbering scheme &quot;</span><span class="si">{</span><span class="n">num_scheme</span><span class="si">}</span><span class="s1">&quot;.&#39;</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="n">run_method</span> <span class="o">==</span> <span class="s1">&#39;serial&#39;</span><span class="p">:</span>
                <span class="n">process_items</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">process_items</span> <span class="o">=</span> <span class="p">[</span><span class="n">number</span><span class="p">]</span>
            <span class="n">process_items</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_get_file_name</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">ext</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">path</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">ext</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">path_list</span><span class="p">,</span> <span class="n">pattern_list</span><span class="p">,</span> <span class="n">ext_list</span><span class="p">)</span>
            <span class="p">])</span>
            <span class="n">process_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">process_items</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">process_list</span></div>

<div class="viewcode-block" id="FileHandler._save_process_list"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler._save_process_list">[docs]</a>    <span class="k">def</span> <span class="nf">_save_process_list</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dir_list</span><span class="p">,</span>
        <span class="n">pattern_list</span><span class="p">,</span>
        <span class="n">ext_list</span><span class="p">,</span>
        <span class="n">num_scheme</span><span class="p">,</span>
        <span class="n">run_method</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save Process List.</span>

<span class="sd">        Save list of processes to a numpy binary.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dir_list : list</span>
<span class="sd">            List of input directories</span>
<span class="sd">        pattern_list : list</span>
<span class="sd">            List of file patterns</span>
<span class="sd">        ext_list : list</span>
<span class="sd">            List of file extensions</span>
<span class="sd">        num_scheme : str</span>
<span class="sd">            Numbering scheme</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">np_mmap_list</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setpath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tmp_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;nums_</span><span class="si">{</span><span class="n">pattern</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s1">.npy&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">ext</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pattern_list</span><span class="p">,</span> <span class="n">ext_list</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">match_mmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setpath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tmp_dir</span><span class="p">,</span> <span class="s1">&#39;matching_num_patterns.npy&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_mmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setpath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tmp_dir</span><span class="p">,</span> <span class="s1">&#39;process_list.npy&#39;</span><span class="p">)</span>

        <span class="n">re_pattern</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_re</span><span class="p">(</span><span class="n">num_scheme</span><span class="p">)</span>

        <span class="n">temp</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_save_num_patterns</span><span class="p">(</span>
                <span class="n">dir_list</span><span class="p">,</span>
                <span class="n">re_pattern</span><span class="p">,</span>
                <span class="n">pattern</span><span class="p">,</span>
                <span class="n">ext</span><span class="p">,</span>
                <span class="n">np_mmap</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">ext</span><span class="p">,</span> <span class="n">np_mmap</span> <span class="ow">in</span>
            <span class="nb">zip</span><span class="p">(</span><span class="n">pattern_list</span><span class="p">,</span> <span class="n">ext_list</span><span class="p">,</span> <span class="n">np_mmap_list</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_save_match_patterns</span><span class="p">(</span><span class="n">match_mmap</span><span class="p">,</span> <span class="n">np_mmap_list</span><span class="p">)</span>

        <span class="n">process_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_process_list</span><span class="p">(</span>
            <span class="n">temp</span><span class="p">,</span>
            <span class="n">match_mmap</span><span class="p">,</span>
            <span class="n">re_pattern</span><span class="p">,</span>
            <span class="n">num_scheme</span><span class="p">,</span>
            <span class="n">run_method</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">process_mmap</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">process_list</span><span class="p">))</span>
        <span class="k">del</span> <span class="n">process_list</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">process_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">process_mmap</span><span class="p">,</span> <span class="n">mmap_mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">missed</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_remove_mmaps</span><span class="p">(</span><span class="n">np_mmap_list</span> <span class="o">+</span> <span class="p">[</span><span class="n">match_mmap</span><span class="p">])</span></div>

<div class="viewcode-block" id="FileHandler.remove_process_mmap"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler.remove_process_mmap">[docs]</a>    <span class="k">def</span> <span class="nf">remove_process_mmap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove Process MMAP.</span>

<span class="sd">        Remove process list memory map.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_remove_mmaps</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">process_mmap</span><span class="p">])</span></div>

<div class="viewcode-block" id="FileHandler._get_module_input_files"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler._get_module_input_files">[docs]</a>    <span class="k">def</span> <span class="nf">_get_module_input_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">run_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Module Input Files.</span>

<span class="sd">        Retrieve the module input files names from the input directory.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        module : str</span>
<span class="sd">            Module name</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dir_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;input_dir&#39;</span><span class="p">]</span>
        <span class="n">pattern_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;file_pattern&#39;</span><span class="p">]</span>
        <span class="n">ext_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;file_ext&#39;</span><span class="p">]</span>
        <span class="n">num_scheme</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;numbering_scheme&#39;</span><span class="p">]</span>
        <span class="n">run_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;run_method&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_save_process_list</span><span class="p">(</span>
            <span class="n">dir_list</span><span class="p">,</span>
            <span class="n">pattern_list</span><span class="p">,</span>
            <span class="n">ext_list</span><span class="p">,</span>
            <span class="n">num_scheme</span><span class="p">,</span>
            <span class="n">run_method</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="FileHandler.set_up_module"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler.set_up_module">[docs]</a>    <span class="k">def</span> <span class="nf">set_up_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Up Module.</span>

<span class="sd">        Set up module parameters for file handler.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        module : str</span>
<span class="sd">            Module name</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">multi_call</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module_list</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">module</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">module</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="s1">&#39;run_count&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="s1">&#39;run_count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">multi_call</span><span class="p">:</span>
            <span class="n">call_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="s1">&#39;run_count&#39;</span><span class="p">]</span>
            <span class="n">run_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">module</span><span class="si">}</span><span class="s1">_run_</span><span class="si">{</span><span class="n">call_num</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">run_name</span> <span class="o">=</span> <span class="n">module</span>

        <span class="c1"># Log run count</span>
        <span class="n">module_prop_text</span> <span class="o">=</span> <span class="s1">&#39; - Module properties&#39;</span>
        <span class="n">module_run_num</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39; -- Run: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="s2">&quot;run_count&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">module_prop_text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">module_run_num</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">module_prop_text</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">module_run_num</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="s1">&#39;latest&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">run_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_module_properties</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">run_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_module_run_dirs</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">run_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_module_input_dir</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">run_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_get_module_input_files</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">run_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="FileHandler.get_worker_log_name"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_handler.html#shapepipe.pipeline.file_handler.FileHandler.get_worker_log_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_worker_log_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">file_number_string</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Worker Log Name.</span>

<span class="sd">        This method generates a worker log name.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        module : str</span>
<span class="sd">            Module name</span>
<span class="sd">        file_number_string : str</span>
<span class="sd">            File numbering in output</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            Worker log file name</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">run_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="s1">&#39;latest&#39;</span><span class="p">]</span>
        <span class="n">log_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module_dict</span><span class="p">[</span><span class="n">module</span><span class="p">][</span><span class="n">run_name</span><span class="p">][</span><span class="s1">&#39;log_dir&#39;</span><span class="p">]</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">log_dir</span><span class="si">}</span><span class="s1">/process</span><span class="si">{</span><span class="n">file_number_string</span><span class="si">}</span><span class="s1">&#39;</span></div></div>
</pre></div>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Samuel Farrens<br/>
    
        &copy; Copyright 2018, Samuel Farrens.<br/>
      Last updated on 14 Mar, 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>