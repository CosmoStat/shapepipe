
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>shapepipe.pipeline.file_io &#8212; ShapePipe v1.0</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet">
  <link href="../../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-book-theme.css?digest=84ace793992934648b4de8eed757e5a2" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx-book-theme.9d8b4a8b9bb19db25eeaddc40d639ba2.js"></script>
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<div class="col-12 col-md-3 bd-sidebar site-navigation " id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">ShapePipe v1.0</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  About ShapePipe
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../about.html">
   About
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../contributors.html">
   Contributors
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Installing ShapePipe
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../dependencies.html">
   Dependencies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../installation.html">
   Installation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Running ShapePipe
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../basic_execution.html">
   Basic Execution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../configuration.html">
   Configuration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../testing.html">
   Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../pipeline_tutorial.html">
   ShapePipe Tutorial
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Miscellaneous
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../post_processing.html">
   Post-processing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../random_cat.html">
   Create random catalogue
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  API Documentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../understanding_api.html">
   Understanding the API Documentation
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../shapepipe.html">
   shapepipe
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../shapepipe.modules.html">
     shapepipe.modules
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.find_exposures_package.html">
       shapepipe.modules.find_exposures_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
      <label for="toctree-checkbox-3">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.find_exposures_package.find_exposures.html">
         shapepipe.modules.find_exposures_package.find_exposures
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.get_images_package.html">
       shapepipe.modules.get_images_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
      <label for="toctree-checkbox-4">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.get_images_package.get_images.html">
         shapepipe.modules.get_images_package.get_images
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.make_cat_package.html">
       shapepipe.modules.make_cat_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
      <label for="toctree-checkbox-5">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.make_cat_package.make_cat.html">
         shapepipe.modules.make_cat_package.make_cat
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.mask_package.html">
       shapepipe.modules.mask_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
      <label for="toctree-checkbox-6">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.mask_package.mask.html">
         shapepipe.modules.mask_package.mask
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.match_external_package.html">
       shapepipe.modules.match_external_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
      <label for="toctree-checkbox-7">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.match_external_package.match_external.html">
         shapepipe.modules.match_external_package.match_external
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.mccd_package.html">
       shapepipe.modules.mccd_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
      <label for="toctree-checkbox-8">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.mccd_package.mccd_interpolation_script.html">
         shapepipe.modules.mccd_package.mccd_interpolation_script
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.mccd_package.mccd_plot_utilities.html">
         shapepipe.modules.mccd_package.mccd_plot_utilities
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.mccd_package.shapepipe_auxiliary_mccd.html">
         shapepipe.modules.mccd_package.shapepipe_auxiliary_mccd
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.merge_headers_package.html">
       shapepipe.modules.merge_headers_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
      <label for="toctree-checkbox-9">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.merge_headers_package.merge_headers.html">
         shapepipe.modules.merge_headers_package.merge_headers
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.merge_sep_cats_package.html">
       shapepipe.modules.merge_sep_cats_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
      <label for="toctree-checkbox-10">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.merge_sep_cats_package.merge_sep_cats.html">
         shapepipe.modules.merge_sep_cats_package.merge_sep_cats
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.merge_starcat_package.html">
       shapepipe.modules.merge_starcat_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
      <label for="toctree-checkbox-11">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.merge_starcat_package.merge_starcat.html">
         shapepipe.modules.merge_starcat_package.merge_starcat
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.ngmix_package.html">
       shapepipe.modules.ngmix_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
      <label for="toctree-checkbox-12">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.ngmix_package.ngmix.html">
         shapepipe.modules.ngmix_package.ngmix
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.pastecat_package.html">
       shapepipe.modules.pastecat_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
      <label for="toctree-checkbox-13">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.pastecat_package.pastecat.html">
         shapepipe.modules.pastecat_package.pastecat
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.psfex_interp_package.html">
       shapepipe.modules.psfex_interp_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
      <label for="toctree-checkbox-14">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.psfex_interp_package.psfex_interp.html">
         shapepipe.modules.psfex_interp_package.psfex_interp
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.psfex_package.html">
       shapepipe.modules.psfex_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
      <label for="toctree-checkbox-15">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.psfex_package.psfex_script.html">
         shapepipe.modules.psfex_package.psfex_script
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.python_example_package.html">
       shapepipe.modules.python_example_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
      <label for="toctree-checkbox-16">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.python_example_package.python_example.html">
         shapepipe.modules.python_example_package.python_example
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.random_cat_package.html">
       shapepipe.modules.random_cat_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
      <label for="toctree-checkbox-17">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.random_cat_package.random_cat.html">
         shapepipe.modules.random_cat_package.random_cat
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.setools_package.html">
       shapepipe.modules.setools_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
      <label for="toctree-checkbox-18">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.setools_package.setools.html">
         shapepipe.modules.setools_package.setools
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.sextractor_package.html">
       shapepipe.modules.sextractor_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
      <label for="toctree-checkbox-19">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.sextractor_package.sextractor_script.html">
         shapepipe.modules.sextractor_package.sextractor_script
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.split_exp_package.html">
       shapepipe.modules.split_exp_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
      <label for="toctree-checkbox-20">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.split_exp_package.split_exp.html">
         shapepipe.modules.split_exp_package.split_exp
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.spread_model_package.html">
       shapepipe.modules.spread_model_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
      <label for="toctree-checkbox-21">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.spread_model_package.spread_model.html">
         shapepipe.modules.spread_model_package.spread_model
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.uncompress_fits_package.html">
       shapepipe.modules.uncompress_fits_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
      <label for="toctree-checkbox-22">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.uncompress_fits_package.uncompress_fits.html">
         shapepipe.modules.uncompress_fits_package.uncompress_fits
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../shapepipe.modules.vignetmaker_package.html">
       shapepipe.modules.vignetmaker_package
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
      <label for="toctree-checkbox-23">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../shapepipe.modules.vignetmaker_package.vignetmaker.html">
         shapepipe.modules.vignetmaker_package.vignetmaker
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.modules.module_decorator.html">
       shapepipe.modules.module_decorator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.modules.module_runners.html">
       shapepipe.modules.module_runners
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../shapepipe.pipeline.html">
     shapepipe.pipeline
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/>
    <label for="toctree-checkbox-24">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.pipeline.args.html">
       shapepipe.pipeline.args
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.pipeline.config.html">
       shapepipe.pipeline.config
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.pipeline.dependency_handler.html">
       shapepipe.pipeline.dependency_handler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.pipeline.execute.html">
       shapepipe.pipeline.execute
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.pipeline.file_handler.html">
       shapepipe.pipeline.file_handler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.pipeline.file_io.html">
       shapepipe.pipeline.file_io
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.pipeline.job_handler.html">
       shapepipe.pipeline.job_handler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.pipeline.mpi_run.html">
       shapepipe.pipeline.mpi_run
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.pipeline.run_log.html">
       shapepipe.pipeline.run_log
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.pipeline.shared.html">
       shapepipe.pipeline.shared
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.pipeline.str_handler.html">
       shapepipe.pipeline.str_handler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.pipeline.timeout.html">
       shapepipe.pipeline.timeout
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.pipeline.worker_handler.html">
       shapepipe.pipeline.worker_handler
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../shapepipe.utilities.html">
     shapepipe.utilities
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/>
    <label for="toctree-checkbox-25">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.utilities.canfar.html">
       shapepipe.utilities.canfar
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.utilities.cfis.html">
       shapepipe.utilities.cfis
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.utilities.file_system.html">
       shapepipe.utilities.file_system
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../shapepipe.utilities.galaxy.html">
       shapepipe.utilities.galaxy
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../shapepipe.info.html">
     shapepipe.info
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../shapepipe.run.html">
     shapepipe.run
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contributing to ShapePipe
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../contributing.html">
   Contribution Guidelines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../module_develop.html">
   Module Development
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../module_example.html">
   Module Examples
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  References
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../z_ref.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  <p></p>
</div>

</div>


          


          
<!-- This is an invisible pixel that we watch to see if we've scrolled. -->
<div class="sbt-scroll-pixel-helper"></div>
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            <div class="topbar-left">
                
                <label class="nav-toggle-button" for="__navigation">
                    <div class="visually-hidden">Toggle navigation</div>
                    <i class="fas fa-bars"></i>
                </label>
                
            </div>
            
            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/CosmoStat/shapepipe"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/CosmoStat/shapepipe/issues/new?title=Issue%20on%20page%20%2F_modules/shapepipe/pipeline/file_io.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1></h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            
              <div>
                
  <h1>Source code for shapepipe.pipeline.file_io</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;FILE IO.</span>

<span class="sd">This file contains methods for file I/O handling.</span>

<span class="sd">:Author: Marc Gentile and Axel Guinot</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span>
<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span>


<div class="viewcode-block" id="BaseCatalogue"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.BaseCatalogue">[docs]</a><span class="k">class</span> <span class="nc">BaseCatalogue</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base catalogue.</span>

<span class="sd">    Base catalogue management class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fullpath : str</span>
<span class="sd">      Full path to catalogue</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This class is not meant to be used directly</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fullpath</span><span class="p">):</span>

        <span class="c1"># catalogue file path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_directory</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">fullpath</span><span class="p">)</span>
        <span class="c1"># input/output format</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_format</span> <span class="o">=</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">InputFormat</span><span class="o">.</span><span class="n">Undefined</span>
        <span class="c1"># catalogue internal data (e.g. AsciiData class)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fullpath</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Full Path.</span>

<span class="sd">        Get the full path of the catalogue file</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_directory</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">directory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Directory.</span>

<span class="sd">        Get the directory of the catalogue file</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_directory</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">filename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set File Name.</span>

<span class="sd">        Get the name of the catalogue file</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">format</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Format.</span>

<span class="sd">        Get the default input/output format of the catalogue</span>
<span class="sd">        (e.g. Text, SExtractor, FITS)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format</span>

<div class="viewcode-block" id="BaseCatalogue.get_nb_rows"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.BaseCatalogue.get_nb_rows">[docs]</a>    <span class="k">def</span> <span class="nf">get_nb_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Number of Rows.</span>

<span class="sd">        Get the number of rows in the catalogue</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            Number of rows</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">FeatureNotImplemented</span><span class="p">(</span><span class="s1">&#39;get_nb_rows()&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseCatalogue.get_nb_cols"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.BaseCatalogue.get_nb_cols">[docs]</a>    <span class="k">def</span> <span class="nf">get_nb_cols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Number of Columns.</span>

<span class="sd">        Get the number of columns in the catalogue</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            Number of columns</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">FeatureNotImplemented</span><span class="p">(</span><span class="s2">&quot;get_nb_cols()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseCatalogue.get_col_names"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.BaseCatalogue.get_col_names">[docs]</a>    <span class="k">def</span> <span class="nf">get_col_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Column Names.</span>

<span class="sd">        Get the list of column names in the catalogue</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            list of column names</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">FeatureNotImplemented</span><span class="p">(</span><span class="s1">&#39;get_col_names()&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseCatalogue.get_col_formats"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.BaseCatalogue.get_col_formats">[docs]</a>    <span class="k">def</span> <span class="nf">get_col_formats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Column Formats.</span>

<span class="sd">        Get the list of column formats in the order of columns</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">FeatureNotImplemented</span><span class="p">(</span><span class="s1">&#39;get_col_names()&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseCatalogue.add_col"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.BaseCatalogue.add_col">[docs]</a>    <span class="k">def</span> <span class="nf">add_col</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">col_name</span><span class="p">,</span>
        <span class="n">col_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">col_comment</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">col_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add Column.</span>

<span class="sd">        Add a Column to the catalogue</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        col_name : str</span>
<span class="sd">            Column name</span>
<span class="sd">        col_format : str</span>
<span class="sd">            Column python format</span>
<span class="sd">        col_comment : str</span>
<span class="sd">            Column comment (ignored in for class)</span>
<span class="sd">        col_data : numpy.ndarray</span>
<span class="sd">            Column data as a numpy array</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">FeatureNotImplemented</span><span class="p">(</span><span class="s1">&#39;add_col()&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseCatalogue._file_exists"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.BaseCatalogue._file_exists">[docs]</a>    <span class="k">def</span> <span class="nf">_file_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;File Exists.</span>

<span class="sd">        Check if input file path is a valid file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filepath : str</span>
<span class="sd">            Path to file</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="BaseCatalogue.InputFormat"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.BaseCatalogue.InputFormat">[docs]</a>    <span class="k">class</span> <span class="nc">InputFormat</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Supported input catalogue formats.&quot;&quot;&quot;</span>

        <span class="n">Undefined</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">TabulatedText</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">SExtractor</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">FITS</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">FITS_LDAC</span> <span class="o">=</span> <span class="mi">5</span></div>

<div class="viewcode-block" id="BaseCatalogue.OpenMode"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.BaseCatalogue.OpenMode">[docs]</a>    <span class="k">class</span> <span class="nc">OpenMode</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Supported input catalogue open modes.&quot;&quot;&quot;</span>

        <span class="n">ReadOnly</span> <span class="o">=</span> <span class="s1">&#39;readonly&#39;</span>
        <span class="n">ReadWrite</span> <span class="o">=</span> <span class="s1">&#39;update&#39;</span>
        <span class="n">Append</span> <span class="o">=</span> <span class="s1">&#39;append&#39;</span></div>

<div class="viewcode-block" id="BaseCatalogue.Column"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.BaseCatalogue.Column">[docs]</a>    <span class="k">class</span> <span class="nc">Column</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Column.</span>

<span class="sd">        Represents a column in the catalogue.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cat_col</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="nd">@property</span>
        <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Set Name.</span>

<span class="sd">            Get the name of the column</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">FeatureNotImplemented</span><span class="p">(</span><span class="s1">&#39;column.name&#39;</span><span class="p">)</span>

        <span class="nd">@property</span>
        <span class="k">def</span> <span class="nf">format</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Format.</span>

<span class="sd">            Get the format of the column</span>

<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">FeatureNotImplemented</span><span class="p">(</span><span class="s1">&#39;column.format&#39;</span><span class="p">)</span>

        <span class="nd">@property</span>
        <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Set Data.</span>

<span class="sd">            Get the data associated with the column</span>

<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">FeatureNotImplemented</span><span class="p">(</span><span class="s1">&#39;column.data&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="BaseCatalogue.Column.get_nb_rows"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.BaseCatalogue.Column.get_nb_rows">[docs]</a>        <span class="k">def</span> <span class="nf">get_nb_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Get Number of Rows.</span>

<span class="sd">            Retrieve the number of rows of the column.</span>

<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">FeatureNotImplemented</span><span class="p">(</span><span class="s1">&#39;get_nb_rows()&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseCatalogue.Column.get_info"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.BaseCatalogue.Column.get_info">[docs]</a>        <span class="k">def</span> <span class="nf">get_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Get Information.</span>

<span class="sd">            Retrieve information about the column.</span>

<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">FeatureNotImplemented</span><span class="p">(</span><span class="s1">&#39;get_info()&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseCatalogue.Column.get_type"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.BaseCatalogue.Column.get_type">[docs]</a>        <span class="k">def</span> <span class="nf">get_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Get Type.</span>

<span class="sd">            Get the data type of the column</span>

<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">FeatureNotImplemented</span><span class="p">(</span><span class="s1">&#39;get_type()&#39;</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="BaseCatalogue.FeatureNotImplemented"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.BaseCatalogue.FeatureNotImplemented">[docs]</a>    <span class="k">class</span> <span class="nc">FeatureNotImplemented</span><span class="p">(</span><span class="ne">NotImplementedError</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Feature Not Implemented.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        msg : str</span>
<span class="sd">            Message</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span> <span class="o">=</span> <span class="n">msg</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;File IO *** ERROR ***: Feature: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="si">}</span><span class="s1"> is not &#39;</span>
                <span class="o">+</span> <span class="s1">&#39;implemented in this class&#39;</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="BaseCatalogue.catalogueNotOpen"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.BaseCatalogue.catalogueNotOpen">[docs]</a>    <span class="k">class</span> <span class="nc">catalogueNotOpen</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Catalogue Not Open.</span>

<span class="sd">        Catalogue has not been open yet.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filepath : str</span>
<span class="sd">            Path to file</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_filepath</span> <span class="o">=</span> <span class="n">filepath</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;File IO *** ERROR ***: catalogue: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_filepath</span><span class="si">}</span><span class="s1"> &#39;</span>
                <span class="o">+</span> <span class="s1">&#39;is not open&#39;</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="BaseCatalogue.DataNotFound"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.BaseCatalogue.DataNotFound">[docs]</a>    <span class="k">class</span> <span class="nc">DataNotFound</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Data Not Found.</span>

<span class="sd">        No data found (at given hdu).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filepath : str</span>
<span class="sd">            Path to file</span>
<span class="sd">        hdu : int</span>
<span class="sd">            HDU number</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">hdu</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_filepath</span> <span class="o">=</span> <span class="n">filepath</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_hdu</span> <span class="o">=</span> <span class="n">hdu</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;File IO *** ERROR ***: File </span><span class="se">\&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_filepath</span><span class="si">}</span><span class="se">\&#39;</span><span class="s1">, &#39;</span>
                <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;hdu=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_hdu</span><span class="si">}</span><span class="s1">: data not found&#39;</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="BaseCatalogue.catalogueFileNotFound"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.BaseCatalogue.catalogueFileNotFound">[docs]</a>    <span class="k">class</span> <span class="nc">catalogueFileNotFound</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Catalogue File Not Found.</span>

<span class="sd">        Exception thrown when a catalogue file is not found on disk.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filepath : str</span>
<span class="sd">            Path to file</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_filepath</span> <span class="o">=</span> <span class="n">filepath</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Set string representation of the exception object.&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;File IO *** ERROR ***: file </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_filepath</span><span class="si">}</span><span class="s1"> no found&#39;</span></div>

<div class="viewcode-block" id="BaseCatalogue.ColumnNotFound"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.BaseCatalogue.ColumnNotFound">[docs]</a>    <span class="k">class</span> <span class="nc">ColumnNotFound</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Column Not Found.</span>

<span class="sd">        Exception thrown when a named catalogue column could not be found</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        col_name : str</span>
<span class="sd">            Column name</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_name</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_col_name</span> <span class="o">=</span> <span class="n">col_name</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Set string representation of the exception object.&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;File IO *** ERROR ***: column </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_col_name</span><span class="si">}</span><span class="s1"> no found&#39;</span></div>

<div class="viewcode-block" id="BaseCatalogue.catalogueNotCreated"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.BaseCatalogue.catalogueNotCreated">[docs]</a>    <span class="k">class</span> <span class="nc">catalogueNotCreated</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Catalogue Not Created.</span>

<span class="sd">        Catalogue could not be created.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filepath : str</span>
<span class="sd">            Path to file</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_filepath</span> <span class="o">=</span> <span class="n">filepath</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;File IO *** ERROR ***: catalogue: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_filepath</span><span class="si">}</span><span class="s1"> could &#39;</span>
                <span class="o">+</span> <span class="s1">&#39;not be created&#39;</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="BaseCatalogue.OpenModeNotSupported"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.BaseCatalogue.OpenModeNotSupported">[docs]</a>    <span class="k">class</span> <span class="nc">OpenModeNotSupported</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Open Mode Not Supported.</span>

<span class="sd">        Opening mode not supported by this version.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filepath : str</span>
<span class="sd">            Path to file</span>
<span class="sd">        open_mode : OpenMode</span>
<span class="sd">            File opening mode</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">open_mode</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_filepath</span> <span class="o">=</span> <span class="n">filepath</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_open_mode</span> <span class="o">=</span> <span class="n">open_mode</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;File IO *** ERROR ***: catalogue: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_filepath</span><span class="si">}</span><span class="s1"> &#39;</span>
                <span class="o">+</span> <span class="s1">&#39;Open Mode </span><span class="si">{self._open_mode}</span><span class="s1"> not supported&#39;</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="BaseCatalogue.OpenModeConflict"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.BaseCatalogue.OpenModeConflict">[docs]</a>    <span class="k">class</span> <span class="nc">OpenModeConflict</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Open Mode Conflict.</span>

<span class="sd">        Opening mode is in conflict with an action.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        open_mode : OpenMode</span>
<span class="sd">            File opening mode</span>
<span class="sd">        open_mode_needed : OpenMode</span>
<span class="sd">            File opening mode needed</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">open_mode</span><span class="p">,</span> <span class="n">open_mode_needed</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_open_mode</span> <span class="o">=</span> <span class="n">open_mode</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_open_mode_needed</span> <span class="o">=</span> <span class="n">open_mode_needed</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="s1">&#39;File IO *** ERROR ***: catalogue has to be open as : &#39;</span>
                <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_open_mode_needed</span><span class="si">}</span><span class="s1"> , Mode used : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_open_mode</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="p">)</span></div></div>


<div class="viewcode-block" id="FITSCatalogue"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue">[docs]</a><span class="k">class</span> <span class="nc">FITSCatalogue</span><span class="p">(</span><span class="n">BaseCatalogue</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;FITS Catalogue.</span>

<span class="sd">    Catalogues management in .FITS format.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fullpath : str</span>
<span class="sd">        Full path to file</span>
<span class="sd">    hdu_no : int</span>
<span class="sd">        HDU number</span>
<span class="sd">    open_mode : OpenMode</span>
<span class="sd">        File opening mode</span>
<span class="sd">    memmap : Bool</span>
<span class="sd">        Option to use memory mapping</span>
<span class="sd">    SEx_catalogue : bool</span>
<span class="sd">        Option to specify if the input is a SExtractor catalogue</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">fullpath</span><span class="p">,</span>
        <span class="n">hdu_no</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">open_mode</span><span class="o">=</span><span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">OpenMode</span><span class="o">.</span><span class="n">ReadOnly</span><span class="p">,</span>
        <span class="n">memmap</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">SEx_catalogue</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">BaseCatalogue</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fullpath</span><span class="p">)</span>

        <span class="c1"># default input/output format</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_format</span> <span class="o">=</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">InputFormat</span><span class="o">.</span><span class="n">FITS</span>

        <span class="c1"># opening mode (see FITSCatalogue.OpenMode)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_open_mode</span> <span class="o">=</span> <span class="n">open_mode</span>
        <span class="c1"># Work with SExtractor fits format or not</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_SEx_catalogue</span> <span class="o">=</span> <span class="n">SEx_catalogue</span>
        <span class="c1"># HDU number of the underlying .FITS table</span>
        <span class="k">if</span> <span class="n">hdu_no</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Default is 1 (or 2 if you are using )</span>
            <span class="k">if</span> <span class="n">SEx_catalogue</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_hdu_no</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_hdu_no</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_hdu_no</span> <span class="o">=</span> <span class="n">hdu_no</span>
        <span class="c1"># use memory mapping or not</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_use_memmap</span> <span class="o">=</span> <span class="n">memmap</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">info</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_info</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">info</span> <span class="o">=</span> <span class="s1">&#39;No information&#39;</span>
        <span class="k">return</span> <span class="n">info</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hdu_no</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set HDU Number.</span>

<span class="sd">        Get the HDU index of the table.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hdu_no</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">open_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set Open Mode.</span>

<span class="sd">        Return the catalogue opening mode.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        FITSCatalogue.OpenMode</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_open_mode</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">use_memmap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Use Memory Map.</span>

<span class="sd">        If True, use memory mapping.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_memmap</span>

    <span class="nd">@hdu_no</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">hdu_no</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hdu_no</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hdu_no</span> <span class="o">=</span> <span class="n">hdu_no</span>

    <span class="nd">@open_mode</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">open_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">open_mode</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_open_mode</span> <span class="o">=</span> <span class="n">open_mode</span>

    <span class="nd">@use_memmap</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">use_memmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_memmap</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_use_memmap</span> <span class="o">=</span> <span class="n">use_memmap</span>

<div class="viewcode-block" id="FITSCatalogue.open"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.open">[docs]</a>    <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Open.</span>

<span class="sd">        Open an existing catalogue.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">):</span>

            <span class="c1"># Open catalogue file</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_mode</span><span class="p">,</span>
                <span class="n">memmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_memmap</span><span class="p">,</span>
                <span class="n">ignore_missing_end</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">catalogueFileNotFound</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span></div>

<div class="viewcode-block" id="FITSCatalogue.create"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.create">[docs]</a>    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ext_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">s_hdu</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sex_cat_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create.</span>

<span class="sd">        Create an empty catalogue in FITS format.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ext_name : str</span>
<span class="sd">            Extension name or number</span>
<span class="sd">        s_hdu : bool</span>
<span class="sd">            If true add a secondary HDU</span>
<span class="sd">        sex_cat_path : str</span>
<span class="sd">            Path to SEXtractor catalogue</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">primary_hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">PrimaryHDU</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_SEx_catalogue</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">sex_cat_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_exists</span><span class="p">(</span><span class="n">sex_cat_path</span><span class="p">):</span>
                    <span class="n">sex_cat</span> <span class="o">=</span> <span class="n">FITSCatalogue</span><span class="p">(</span><span class="n">sex_cat_path</span><span class="p">,</span> <span class="n">hdu_no</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">sex_cat</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
                    <span class="n">secondary_hdu</span> <span class="o">=</span> <span class="n">sex_cat</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">HDUList</span><span class="p">([</span><span class="n">primary_hdu</span><span class="p">,</span> <span class="n">secondary_hdu</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">sex_cat</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                    <span class="k">del</span> <span class="n">sex_cat</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">catalogueFileNotFound</span><span class="p">(</span><span class="n">sex_cat_path</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;sex_cat_path needs to be provided to create a &#39;</span>
                    <span class="o">+</span> <span class="s1">&#39;SEXtractor catalogue&#39;</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="n">s_hdu</span><span class="p">:</span>
            <span class="n">secondary_hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">BinTableHDU</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">ext_name</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">HDUList</span><span class="p">([</span><span class="n">primary_hdu</span><span class="p">,</span> <span class="n">secondary_hdu</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">HDUList</span><span class="p">([</span><span class="n">primary_hdu</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="FITSCatalogue.copy_hdu"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.copy_hdu">[docs]</a>    <span class="k">def</span> <span class="nf">copy_hdu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fits_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hdu_no</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hdu_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Copy HDU.</span>

<span class="sd">        Copy an HDU from a FITS file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fits_file : str</span>
<span class="sd">            Catalogue containing the HDU</span>
<span class="sd">        hdu_no : int</span>
<span class="sd">            HDU number</span>
<span class="sd">        hdu_name : str</span>
<span class="sd">            HDU name</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">fits_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fits_file</span> <span class="o">=</span> <span class="bp">self</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">catalogueNotOpen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fits_file</span><span class="o">.</span><span class="n">_cat_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">catalogueNotOpen</span><span class="p">(</span><span class="n">fits_file</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hdu_no</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">hdu_no</span> <span class="o">=</span> <span class="n">fits_file</span><span class="o">.</span><span class="n">hdu_no</span>

        <span class="k">if</span> <span class="n">hdu_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">hdu_name</span> <span class="o">=</span> <span class="n">fits_file</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">[</span><span class="n">hdu_no</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">fits</span><span class="o">.</span><span class="n">BinTableHDU</span><span class="p">(</span><span class="n">fits_file</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">hdu_no</span><span class="o">=</span><span class="n">hdu_no</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="n">hdu_name</span><span class="p">)</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="FITSCatalogue.apply_mask"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.apply_mask">[docs]</a>    <span class="k">def</span> <span class="nf">apply_mask</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">fits_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">hdu_no</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">hdu_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply Mask.</span>

<span class="sd">        Apply a mask to data for a specified HDU.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fits_file : str</span>
<span class="sd">            FITS file containing the data to be masked</span>
<span class="sd">        hdu_no : int</span>
<span class="sd">            HDU number</span>
<span class="sd">        mask : numpy.ndarray</span>
<span class="sd">            Array of booleans or an array of indices</span>
<span class="sd">        hdu_name : str</span>
<span class="sd">            HDU name</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This will create a new HDU containing data[mask]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">fits_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fits_file</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">catalogueNotOpen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fits_file</span><span class="o">.</span><span class="n">_cat_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">catalogueNotOpen</span><span class="p">(</span><span class="n">fits_file</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Mask not provided&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Mask need to be a numpy.ndarray&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">hdu_no</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">hdu_no</span> <span class="o">=</span> <span class="n">fits_file</span><span class="o">.</span><span class="n">hdu_no</span>

        <span class="k">if</span> <span class="n">hdu_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">hdu_name</span> <span class="o">=</span> <span class="n">fits_file</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">[</span><span class="n">hdu_no</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>

        <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">bool</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">fits</span><span class="o">.</span><span class="n">BinTableHDU</span><span class="p">(</span>
                    <span class="n">fits_file</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">hdu_no</span><span class="p">)[:][</span><span class="n">mask</span><span class="p">],</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">hdu_name</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">mask</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">fits</span><span class="o">.</span><span class="n">BinTableHDU</span><span class="p">(</span>
                    <span class="n">fits_file</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">hdu_no</span><span class="p">)[:][</span><span class="n">mask</span><span class="p">],</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">hdu_name</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Mask type must be of type int or bool&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="FITSCatalogue.save_as_fits"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.save_as_fits">[docs]</a>    <span class="k">def</span> <span class="nf">save_as_fits</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">ext_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">sex_cat_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">image</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">image_header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save as FITS.</span>

<span class="sd">        Save data into an existing FITS file or into a new one.</span>

<span class="sd">        Save data from dict, list, numpy.ndarray, numpy.recarray or</span>
<span class="sd">        astropy.io.fits.fitsrec.FITS_rec (data format in an astropy fits file)</span>
<span class="sd">        When creating a new FITS to store BinTable data it create a PrimaryHDU.</span>
<span class="sd">        When creating a new FITS to store Image there is no PrimaryHDU.</span>
<span class="sd">        You can create a SExtractor format FITS by specifying a SExtractor</span>
<span class="sd">        catalogue from where data come from.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data : numpy.ndarray</span>
<span class="sd">            Data to be stored</span>
<span class="sd">        names : list</span>
<span class="sd">            List of column names</span>
<span class="sd">        ext_name : str</span>
<span class="sd">            Name of the HDU where data are stored</span>
<span class="sd">        sex_cat_path : str</span>
<span class="sd">            Path of the existing SExtractor catalogue to mimic</span>
<span class="sd">        image : bool</span>
<span class="sd">            If true create a fits image</span>
<span class="sd">        image_header : astropy.io.fits.header</span>
<span class="sd">            Header to use when saving an image</span>
<span class="sd">        overwrite : bool</span>
<span class="sd">            Option to overwrite an existing image, only used when creating a</span>
<span class="sd">            FITS image</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        To create a SExtractor-like FITS file you need to specify</span>
<span class="sd">        ``SEx_catalogue=True`` when declaring the FITSCatalogue object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_mode</span> <span class="o">!=</span> <span class="n">FITSCatalogue</span><span class="o">.</span><span class="n">OpenMode</span><span class="o">.</span><span class="n">ReadWrite</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">OpenModeConflict</span><span class="p">(</span>
                <span class="n">open_mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_mode</span><span class="p">,</span>
                <span class="n">open_mode_needed</span><span class="o">=</span><span class="n">FITSCatalogue</span><span class="o">.</span><span class="n">OpenMode</span><span class="o">.</span><span class="n">ReadWrite</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Data not provided&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">image</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
                <span class="n">names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                <span class="n">it</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)))</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">names</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_save_to_fits</span><span class="p">(</span>
                    <span class="n">data</span><span class="p">,</span>
                    <span class="n">names</span><span class="p">,</span>
                    <span class="n">it</span><span class="p">,</span>
                    <span class="n">ext_name</span><span class="p">,</span>
                    <span class="n">sex_cat_path</span><span class="p">,</span>
                    <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">:</span>
                <span class="n">names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
                <span class="n">it</span> <span class="o">=</span> <span class="n">names</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_save_to_fits</span><span class="p">(</span>
                    <span class="n">data</span><span class="p">,</span>
                    <span class="n">names</span><span class="p">,</span>
                    <span class="n">it</span><span class="p">,</span>
                    <span class="n">ext_name</span><span class="p">,</span>
                    <span class="n">sex_cat_path</span><span class="p">,</span>
                    <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="ow">is</span> <span class="n">fits</span><span class="o">.</span><span class="n">fitsrec</span><span class="o">.</span><span class="n">FITS_rec</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_save_from_recarray</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ext_name</span><span class="p">,</span> <span class="n">sex_cat_path</span><span class="p">)</span>

            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">names</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span>
                        <span class="n">it</span> <span class="o">=</span> <span class="n">names</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Names not provided&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">it</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_save_to_fits</span><span class="p">(</span>
                    <span class="n">data</span><span class="p">,</span>
                    <span class="n">names</span><span class="p">,</span>
                    <span class="n">it</span><span class="p">,</span>
                    <span class="n">ext_name</span><span class="p">,</span>
                    <span class="n">sex_cat_path</span><span class="p">,</span>
                    <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Names not provided&#39;</span><span class="p">)</span>
                <span class="n">it</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">))</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_save_to_fits</span><span class="p">(</span>
                    <span class="n">data</span><span class="p">,</span>
                    <span class="n">names</span><span class="p">,</span>
                    <span class="n">it</span><span class="p">,</span>
                    <span class="n">ext_name</span><span class="p">,</span>
                    <span class="n">sex_cat_path</span><span class="p">,</span>
                    <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Table</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Names not provided&#39;</span><span class="p">)</span>
                <span class="n">it</span> <span class="o">=</span> <span class="n">names</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_save_to_fits</span><span class="p">(</span>
                    <span class="n">data</span><span class="p">,</span>
                    <span class="n">names</span><span class="p">,</span>
                    <span class="n">it</span><span class="p">,</span>
                    <span class="n">ext_name</span><span class="p">,</span>
                    <span class="n">sex_cat_path</span><span class="p">,</span>
                    <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_save_image</span><span class="p">(</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                    <span class="n">header</span><span class="o">=</span><span class="n">image_header</span><span class="p">,</span>
                    <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Data need to be a numpy.ndarray&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="FITSCatalogue.create_from_numpy"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.create_from_numpy">[docs]</a>    <span class="k">def</span> <span class="nf">create_from_numpy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">matrix</span><span class="p">,</span>
        <span class="n">col_names</span><span class="p">,</span>
        <span class="n">ext_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">ext_ver</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create from Numpy.</span>

<span class="sd">        Create a new catalogue from a two-dimensional numpy array.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        matrix : numpy.ndarray</span>
<span class="sd">            Two-dimensional numpy array</span>
<span class="sd">        col_names : list</span>
<span class="sd">            List of column names to use as the header</span>
<span class="sd">        ext_name : str</span>
<span class="sd">            Extension name or number</span>
<span class="sd">        ext_ver : str</span>
<span class="sd">            Extension version</span>
<span class="sd">        header : list</span>
<span class="sd">            List of dictionaries with keys: &#39;card&#39;, name&#39;, &#39;value&#39;,</span>
<span class="sd">            &#39;value_orig&#39;, &#39;comment&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">col_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="n">col_names</span><span class="p">:</span>
            <span class="n">icol</span> <span class="o">=</span> <span class="n">col_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">col_name</span><span class="p">)</span>
            <span class="n">col_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_fits_col_type</span><span class="p">(</span><span class="n">matrix</span><span class="p">[:,</span> <span class="n">icol</span><span class="p">])</span>
            <span class="n">col_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">col_name</span><span class="p">,</span>
                <span class="nb">format</span><span class="o">=</span><span class="n">col_type</span><span class="p">,</span>
                <span class="n">array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">matrix</span><span class="p">[:,</span> <span class="n">icol</span><span class="p">]),</span>
            <span class="p">)</span>
            <span class="n">col_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col_data</span><span class="p">)</span>

        <span class="n">fits_header</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">header</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fits_header</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Header</span><span class="p">()</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">header</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">fits_header</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

        <span class="n">primary_hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">PrimaryHDU</span><span class="p">()</span>
        <span class="n">secondary_hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">BinTableHDU</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span>
            <span class="n">col_list</span><span class="p">,</span>
            <span class="n">header</span><span class="o">=</span><span class="n">fits_header</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">ext_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">secondary_hdu</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">ext_name</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">HDUList</span><span class="p">(</span><span class="n">hdus</span><span class="o">=</span><span class="p">[</span><span class="n">primary_hdu</span><span class="p">,</span> <span class="n">secondary_hdu</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="FITSCatalogue.close"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Close.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_mode</span> <span class="o">==</span> <span class="n">FITSCatalogue</span><span class="o">.</span><span class="n">OpenMode</span><span class="o">.</span><span class="n">ReadWrite</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">catalogueNotOpen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span></div>

<div class="viewcode-block" id="FITSCatalogue.save"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_mode</span> <span class="o">==</span> <span class="n">FITSCatalogue</span><span class="o">.</span><span class="n">OpenMode</span><span class="o">.</span><span class="n">ReadWrite</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">OpenModeConflict</span><span class="p">(</span>
                <span class="n">open_mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_mode</span><span class="p">,</span>
                <span class="n">open_mode_needed</span><span class="o">=</span><span class="n">FITSCatalogue</span><span class="o">.</span><span class="n">OpenMode</span><span class="o">.</span><span class="n">ReadWrite</span><span class="p">,</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="FITSCatalogue.get_nb_rows"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.get_nb_rows">[docs]</a>    <span class="k">def</span> <span class="nf">get_nb_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hdu_no</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Number of Rows.</span>

<span class="sd">        Get the number of rows in the catalogue.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hdu_no : int</span>
<span class="sd">            HDU index</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            Number of rows or 0 if None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nb_rows</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">catalogueNotOpen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hdu_no</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">hdu_no</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdu_no</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">[</span><span class="n">hdu_no</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">nb_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">[</span><span class="n">hdu_no</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">nb_rows</span></div>

<div class="viewcode-block" id="FITSCatalogue.get_nb_cols"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.get_nb_cols">[docs]</a>    <span class="k">def</span> <span class="nf">get_nb_cols</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hdu_no</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Number of Columns.</span>

<span class="sd">        Get the number of columns in the catalogue.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hdu_no : int</span>
<span class="sd">            HDU index</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            Number of columns or 0 if None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">catalogueNotOpen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">hdu_no</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">hdu_no</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdu_no</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_col_names</span><span class="p">(</span><span class="n">hdu_no</span><span class="p">))</span></div>

<div class="viewcode-block" id="FITSCatalogue.get_col_names"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.get_col_names">[docs]</a>    <span class="k">def</span> <span class="nf">get_col_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hdu_no</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Column Names.</span>

<span class="sd">        Get the list of column names in the catalogue.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hdu_no : int</span>
<span class="sd">            HDU index</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            list of column names</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">catalogueNotOpen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hdu_no</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">hdu_no</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdu_no</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">[</span><span class="n">hdu_no</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">names</span></div>

<div class="viewcode-block" id="FITSCatalogue.get_info"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.get_info">[docs]</a>    <span class="k">def</span> <span class="nf">get_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Information.</span>

<span class="sd">        Retrieve some information about the catalogue.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            A dictionary with detailed information</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        See the fitsio documentation of the info() function for the details</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">fits</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span></div>

<div class="viewcode-block" id="FITSCatalogue.get_ext_name"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.get_ext_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_ext_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hdu_no</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Extension Name.</span>

<span class="sd">        Return the name of an extansion or all of them.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hdu_no : int</span>
<span class="sd">            index of the hdu to return, if None return all of them</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str or list</span>
<span class="sd">            The hdu name or a list of strings</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">hdu_no</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">))]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">hdu_no</span><span class="p">)]</span><span class="o">.</span><span class="n">name</span>

        <span class="k">return</span> <span class="n">n</span></div>

<div class="viewcode-block" id="FITSCatalogue.col_exists"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.col_exists">[docs]</a>    <span class="k">def</span> <span class="nf">col_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_name</span><span class="p">,</span> <span class="n">hdu_no</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Column Exists.</span>

<span class="sd">        Check whether a named column exists.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        col_name : str</span>
<span class="sd">            Column name</span>
<span class="sd">        hdu_no : int</span>
<span class="sd">            HDU index</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if column exists, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_col_names</span><span class="p">()</span></div>

<div class="viewcode-block" id="FITSCatalogue.get_col_index"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.get_col_index">[docs]</a>    <span class="k">def</span> <span class="nf">get_col_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_name</span><span class="p">,</span> <span class="n">hdu_no</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Column Index.</span>

<span class="sd">        Get the column index from a column name.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        col_name : str</span>
<span class="sd">            Column name</span>
<span class="sd">        hdu_no : int</span>
<span class="sd">            HDU index</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            Column index (zero-based)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">col_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_col_names</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">col_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">col_names</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">ColumnNotFound</span><span class="p">(</span><span class="n">col_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">col_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">col_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="FITSCatalogue.get_col_data"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.get_col_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_col_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_index</span><span class="p">,</span> <span class="n">hdu_no</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Column Data.</span>

<span class="sd">        Return the data of a column from its index.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        col_name : str</span>
<span class="sd">            Column name</span>
<span class="sd">        hdu_no : int</span>
<span class="sd">            HDU index</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy.ndarray</span>
<span class="sd">            Data associated with the column</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hdu_no</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">hdu_no</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdu_no</span>

            <span class="n">col_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">[</span><span class="n">hdu_no</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">col_index</span><span class="p">]</span><span class="o">.</span><span class="n">array</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col_data</span><span class="p">,</span> <span class="n">fits</span><span class="o">.</span><span class="n">column</span><span class="o">.</span><span class="n">Delayed</span><span class="p">):</span>
                <span class="c1"># trick to force data to be loaded into memory</span>
                <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">[</span><span class="n">hdu_no</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">[</span><span class="n">hdu_no</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">col_index</span><span class="p">]</span><span class="o">.</span><span class="n">array</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">catalogueNotOpen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span></div>

<div class="viewcode-block" id="FITSCatalogue.get_named_col_data"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.get_named_col_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_named_col_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_name</span><span class="p">,</span> <span class="n">hdu_no</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Named Column Data.</span>

<span class="sd">        Return the data of a column from its index (zero-based).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        col_name : str</span>
<span class="sd">            Column name</span>
<span class="sd">        hdu_no : int</span>
<span class="sd">            HDU index</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy.ndarray</span>
<span class="sd">            Data associated with the column</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hdu_no</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">hdu_no</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdu_no</span>

            <span class="n">col_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">[</span><span class="n">hdu_no</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span><span class="o">.</span><span class="n">array</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col_data</span><span class="p">,</span> <span class="n">fits</span><span class="o">.</span><span class="n">column</span><span class="o">.</span><span class="n">Delayed</span><span class="p">):</span>
                <span class="c1"># trick to force data to be loaded into memory</span>
                <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">[</span><span class="n">hdu_no</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">[</span><span class="n">hdu_no</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span><span class="o">.</span><span class="n">array</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">catalogueNotOpen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span></div>

<div class="viewcode-block" id="FITSCatalogue.get_data"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.get_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hdu_no</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Data.</span>

<span class="sd">        Return data of the specified hdu.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hdu_no : int</span>
<span class="sd">            HDU index</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy.ndarray</span>
<span class="sd">            Data associated with the HDU</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hdu_no</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">hdu_no</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdu_no</span>

            <span class="n">dat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">[</span><span class="n">hdu_no</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
            <span class="k">if</span> <span class="n">dat</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">DataNotFound</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdu_no</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">dat</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">catalogueNotOpen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span></div>

<div class="viewcode-block" id="FITSCatalogue.get_header"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.get_header">[docs]</a>    <span class="k">def</span> <span class="nf">get_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hdu_no</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Header.</span>

<span class="sd">        Return the catalogue header as a list of dictionaries.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hdu_no : int</span>
<span class="sd">            HDU index</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        astropy.io.fits.header</span>
<span class="sd">            FITS header</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        See astropy documentation</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hdu_no</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">hdu_no</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdu_no</span>
            <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">[</span><span class="n">hdu_no</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">catalogueNotOpen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span></div>

<div class="viewcode-block" id="FITSCatalogue.get_header_value"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.get_header_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_header_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">hdu_no</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Header Value.</span>

<span class="sd">        Return the value of a parameters or a linear combination of parameters</span>
<span class="sd">        and/or numbers.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        request : str</span>
<span class="sd">            Request parameter or a linear combination of parameters</span>
<span class="sd">        hdu_no : int</span>
<span class="sd">            HDU index</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            Result of the request</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">request</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;request not provided&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">request</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;request has to be a string&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hdu_no</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">hdu_no</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hdu_no</span>

        <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_header</span><span class="p">(</span><span class="n">hdu_no</span><span class="o">=</span><span class="n">hdu_no</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">header</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Empty header in the hdu : </span><span class="si">{</span><span class="n">hdu_no</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">interpreter</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="n">request</span><span class="p">,</span> <span class="n">catalogue</span><span class="o">=</span><span class="n">header</span><span class="p">)</span><span class="o">.</span><span class="n">result</span></div>

<div class="viewcode-block" id="FITSCatalogue.add_header_card"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.add_header_card">[docs]</a>    <span class="k">def</span> <span class="nf">add_header_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hdu_no</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add Header Card.</span>

<span class="sd">        Add a card in the header of the specified HDU.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : str</span>
<span class="sd">            The key to add</span>
<span class="sd">        value : any</span>
<span class="sd">            The value of the key</span>
<span class="sd">        comment : str</span>
<span class="sd">            Comment for the key</span>
<span class="sd">        hdu_no : int</span>
<span class="sd">            HDU index</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_mode</span> <span class="o">!=</span> <span class="n">FITSCatalogue</span><span class="o">.</span><span class="n">OpenMode</span><span class="o">.</span><span class="n">ReadWrite</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">OpenModeConflict</span><span class="p">(</span>
                <span class="n">open_mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_mode</span><span class="p">,</span>
                <span class="n">open_mode_needed</span><span class="o">=</span><span class="n">FITSCatalogue</span><span class="o">.</span><span class="n">OpenMode</span><span class="o">.</span><span class="n">ReadWrite</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">catalogueNotOpen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hdu_no</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">hdu_no</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hdu_no</span>

        <span class="n">card</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;key not provided&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">card</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">card</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">comment</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">card</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">comment</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">card</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>

        <span class="n">card</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">[</span><span class="n">hdu_no</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="FITSCatalogue.get_headers"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.get_headers">[docs]</a>    <span class="k">def</span> <span class="nf">get_headers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Headers.</span>

<span class="sd">        Return the catalogue header as a list of dictionaries.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            list of headers</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">hdu</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">:</span>
                <span class="n">headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">hdu</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">return</span> <span class="n">headers</span></div>

<div class="viewcode-block" id="FITSCatalogue.get_comments"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.get_comments">[docs]</a>    <span class="k">def</span> <span class="nf">get_comments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hdu_no</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Comments.</span>

<span class="sd">        Return the list catalogue comments.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hdu_no : int</span>
<span class="sd">            HDU index</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            List of catalogue comments</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hdu_no</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">hdu_no</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdu_no</span>
            <span class="k">return</span> <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">[</span><span class="n">hdu_no</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">comments</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">[</span><span class="n">hdu_no</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">catalogueNotOpen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span></div>

<div class="viewcode-block" id="FITSCatalogue.get_col_comments"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.get_col_comments">[docs]</a>    <span class="k">def</span> <span class="nf">get_col_comments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hdu_no</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Column Comments.</span>

<span class="sd">        Return the list of column comments.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hdu_no : int</span>
<span class="sd">            HDU index</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            List of column comments</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hdu_no</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">hdu_no</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdu_no</span>
            <span class="n">hdr_col_types</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">tt</span> <span class="k">for</span> <span class="n">tt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">[</span><span class="n">hdu_no</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                <span class="k">if</span> <span class="s1">&#39;TTYPE&#39;</span> <span class="ow">in</span> <span class="n">tt</span>
            <span class="p">]</span>
            <span class="k">return</span> <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">[</span><span class="n">hdu_no</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">comments</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">hdr_col_types</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">catalogueNotOpen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span></div>

<div class="viewcode-block" id="FITSCatalogue.get_col_formats"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.get_col_formats">[docs]</a>    <span class="k">def</span> <span class="nf">get_col_formats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hdu_no</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Column Formats.</span>

<span class="sd">        Get the list of python column formats in the order of columns.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hdu_no : int</span>
<span class="sd">            HDU index</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            List of column formats</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hdu_no</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">hdu_no</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdu_no</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">[</span><span class="n">hdu_no</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">formats</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">catalogueNotOpen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span></div>

<div class="viewcode-block" id="FITSCatalogue.add_col"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.add_col">[docs]</a>    <span class="k">def</span> <span class="nf">add_col</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">col_name</span><span class="p">,</span>
        <span class="n">col_data</span><span class="p">,</span>
        <span class="n">hdu_no</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">ext_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">new_cat</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">new_cat_inst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add Column.</span>

<span class="sd">        Add a Column to the catalogue.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        col_name : str</span>
<span class="sd">            Column name</span>
<span class="sd">        col_data : numpy.ndarray</span>
<span class="sd">            Column data</span>
<span class="sd">        hdu_no : int</span>
<span class="sd">            HDU index</span>
<span class="sd">        ext_name : str, optional</span>
<span class="sd">            Change the name of the extansion</span>
<span class="sd">        new_cat : bool, optional</span>
<span class="sd">            If true will save the changes into a new catalogue</span>
<span class="sd">        new_cat_inst : io.FITSCatalogue</span>
<span class="sd">            New catalogue object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">new_cat</span><span class="p">:</span>
            <span class="n">open_mode</span> <span class="o">=</span> <span class="n">new_cat_inst</span><span class="o">.</span><span class="n">open_mode</span>
            <span class="n">output_path</span> <span class="o">=</span> <span class="n">new_cat_inst</span><span class="o">.</span><span class="n">fullpath</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">open_mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_mode</span>
            <span class="n">output_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">catalogueNotOpen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">open_mode</span> <span class="o">!=</span> <span class="n">FITSCatalogue</span><span class="o">.</span><span class="n">OpenMode</span><span class="o">.</span><span class="n">ReadWrite</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">OpenModeConflict</span><span class="p">(</span>
                <span class="n">open_mode</span><span class="o">=</span><span class="n">open_mode</span><span class="p">,</span>
                <span class="n">open_mode_needed</span><span class="o">=</span><span class="n">FITSCatalogue</span><span class="o">.</span><span class="n">OpenMode</span><span class="o">.</span><span class="n">ReadWrite</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">col_data</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;col_data must be a numpy.ndarray&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hdu_no</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">hdu_no</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdu_no</span>
        <span class="k">if</span> <span class="n">ext_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ext_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">[</span><span class="n">hdu_no</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>

        <span class="n">n_of_hdu</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">)</span>
        <span class="n">old_hdu_prev</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">hdu_no</span><span class="p">):</span>
            <span class="n">old_hdu_prev</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">old_hdu_next</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">hdu_no</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_of_hdu</span><span class="p">):</span>
            <span class="n">old_hdu_next</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">new_fits</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">HDUList</span><span class="p">(</span><span class="n">old_hdu_prev</span><span class="p">)</span>

        <span class="n">col_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="p">[</span><span class="n">hdu_no</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span>

        <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_fits_col_type</span><span class="p">(</span><span class="n">col_data</span><span class="p">)</span>
        <span class="n">data_shape</span> <span class="o">=</span> <span class="n">col_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">dim</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">data_shape</span><span class="p">))</span>
        <span class="n">mem_size</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data_shape</span><span class="p">:</span>
                <span class="n">mem_size</span> <span class="o">*=</span> <span class="n">k</span>
            <span class="n">data_format</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">mem_size</span><span class="si">}{</span><span class="n">data_type</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="n">new_col</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">ColDefs</span><span class="p">([</span><span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">col_name</span><span class="p">,</span>
                <span class="nb">format</span><span class="o">=</span><span class="n">data_format</span><span class="p">,</span>
                <span class="n">array</span><span class="o">=</span><span class="n">col_data</span><span class="p">,</span>
                <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span>
            <span class="p">)])</span>
            <span class="n">col_list</span> <span class="o">+=</span> <span class="n">new_col</span>
        <span class="k">elif</span> <span class="n">data_type</span> <span class="o">==</span> <span class="s1">&#39;A&#39;</span><span class="p">:</span>
            <span class="n">mem_size</span> <span class="o">*=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">col_data</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">len</span><span class="p">))</span>
            <span class="n">data_format</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">mem_size</span><span class="si">}{</span><span class="n">data_type</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="n">new_col</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">ColDefs</span><span class="p">([</span><span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">col_name</span><span class="p">,</span>
                <span class="nb">format</span><span class="o">=</span><span class="n">data_format</span><span class="p">,</span>
                <span class="n">array</span><span class="o">=</span><span class="n">col_data</span><span class="p">,</span>
                <span class="n">dim</span><span class="o">=</span><span class="nb">str</span><span class="p">((</span><span class="n">mem_size</span><span class="p">,)),</span>
            <span class="p">)])</span>
            <span class="n">col_list</span> <span class="o">+=</span> <span class="n">new_col</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_format</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">mem_size</span><span class="si">}{</span><span class="n">data_type</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="n">new_col</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">ColDefs</span><span class="p">([</span><span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">col_name</span><span class="p">,</span>
                <span class="nb">format</span><span class="o">=</span><span class="n">data_format</span><span class="p">,</span>
                <span class="n">array</span><span class="o">=</span><span class="n">col_data</span><span class="p">,</span>
            <span class="p">)])</span>
            <span class="n">col_list</span> <span class="o">+=</span> <span class="n">new_col</span>

        <span class="n">new_fits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">BinTableHDU</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="n">col_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">ext_name</span><span class="p">))</span>

        <span class="n">new_fits</span> <span class="o">+=</span> <span class="n">fits</span><span class="o">.</span><span class="n">HDUList</span><span class="p">(</span><span class="n">old_hdu_next</span><span class="p">)</span>

        <span class="n">new_fits</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">new_cat</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_mode</span><span class="p">,</span>
                <span class="n">memmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_memmap</span><span class="p">,</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="FITSCatalogue.remove_col"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.remove_col">[docs]</a>    <span class="k">def</span> <span class="nf">remove_col</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove Column.</span>

<span class="sd">        Delete a column from its index.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        col_index : int</span>
<span class="sd">            Index of the column to delete</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">FeatureNotImplemented</span><span class="p">(</span><span class="s1">&#39;remove_col()&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="FITSCatalogue.remove_named_col"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.remove_named_col">[docs]</a>    <span class="k">def</span> <span class="nf">remove_named_col</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove Named Column.</span>

<span class="sd">        Delete a column from its index.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        col_name : str</span>
<span class="sd">            Name of the column to delete</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">col_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_col_index</span><span class="p">(</span><span class="n">col_name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_col</span><span class="p">(</span><span class="n">col_index</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">catalogueNotOpen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span></div>

<div class="viewcode-block" id="FITSCatalogue._append_col"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue._append_col">[docs]</a>    <span class="k">def</span> <span class="nf">_append_col</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">hdu_no</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Append Column.</span>

<span class="sd">        Append a Column object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        column : ?</span>
<span class="sd">            An object derived from BaseCatalogue.Column</span>
<span class="sd">        hdu_no : int</span>
<span class="sd">            HDU index</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_col</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">column</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="nb">format</span><span class="o">=</span><span class="n">column</span><span class="o">.</span><span class="n">format</span><span class="p">,</span>
                <span class="n">array</span><span class="o">=</span><span class="n">column</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">hdu_no</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">hdu_no</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdu_no</span>

            <span class="n">orig_table</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)[</span><span class="n">hdu_no</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
            <span class="n">orig_cols</span> <span class="o">=</span> <span class="n">orig_table</span><span class="o">.</span><span class="n">columns</span>

            <span class="n">new_col</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">ColDefs</span><span class="p">([</span><span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">column</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="nb">format</span><span class="o">=</span><span class="n">column</span><span class="o">.</span><span class="n">format</span><span class="p">,</span>
                <span class="n">array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">orig_table</span><span class="p">)),</span>
            <span class="p">)])</span>
            <span class="n">col_list</span> <span class="o">=</span> <span class="n">orig_cols</span> <span class="o">+</span> <span class="n">new_col</span>
            <span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">BinTableHDU</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="n">col_list</span><span class="p">)</span>
            <span class="n">hdu</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">column</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">data</span>
            <span class="n">hdu</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">catalogueNotOpen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span></div>

<div class="viewcode-block" id="FITSCatalogue._get_fits_col_type"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue._get_fits_col_type">[docs]</a>    <span class="k">def</span> <span class="nf">_get_fits_col_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get FITS Column Type.</span>

<span class="sd">        Get the FITS data type of a given column.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        col_data : any</span>
<span class="sd">            Column data</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            Column FITS data type</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">col_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">col_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">col_type</span> <span class="o">=</span> <span class="s1">&#39;D&#39;</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">col_data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">in</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">]:</span>
            <span class="n">col_type</span> <span class="o">=</span> <span class="s1">&#39;I&#39;</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">col_data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">in</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">]:</span>
            <span class="n">col_type</span> <span class="o">=</span> <span class="s1">&#39;J&#39;</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">col_data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">]:</span>
            <span class="n">col_type</span> <span class="o">=</span> <span class="s1">&#39;K&#39;</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">col_data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
            <span class="n">col_type</span> <span class="o">=</span> <span class="s1">&#39;D&#39;</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">col_data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">bool</span><span class="p">:</span>
            <span class="n">col_type</span> <span class="o">=</span> <span class="s1">&#39;L&#39;</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">col_data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">str0</span><span class="p">]:</span>
            <span class="n">col_type</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">col_type</span> <span class="o">=</span> <span class="s1">&#39;D&#39;</span>

        <span class="k">return</span> <span class="n">col_type</span></div>

<div class="viewcode-block" id="FITSCatalogue._get_python_col_type"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue._get_python_col_type">[docs]</a>    <span class="k">def</span> <span class="nf">_get_python_col_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Python Column Type.</span>

<span class="sd">        Get the Python data type of a given column.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        col_data : any</span>
<span class="sd">            Column data</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            Column Python data type</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">col_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">]:</span>
            <span class="n">pcol_type</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span>
        <span class="k">elif</span> <span class="n">col_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">]:</span>
            <span class="n">pcol_type</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%f</span><span class="s1">&#39;</span>
        <span class="k">elif</span> <span class="n">col_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">]:</span>
            <span class="n">pcol_type</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span>
        <span class="k">elif</span> <span class="n">col_type</span> <span class="o">==</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span>
            <span class="n">pcol_type</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pcol_type</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%f</span><span class="s1">&#39;</span>

        <span class="k">return</span> <span class="n">pcol_type</span></div>

<div class="viewcode-block" id="FITSCatalogue._save_to_fits"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue._save_to_fits">[docs]</a>    <span class="k">def</span> <span class="nf">_save_to_fits</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">data</span><span class="p">,</span>
            <span class="n">names</span><span class="p">,</span>
            <span class="n">it</span><span class="p">,</span>
            <span class="n">ext_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">sex_cat_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save to FITS.</span>

<span class="sd">        Save array of data as fits with their associated column names.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data : numpy.ndarray</span>
<span class="sd">            Array with the data</span>
<span class="sd">        names : list</span>
<span class="sd">            List of the column names</span>
<span class="sd">        it : iterator</span>
<span class="sd">            ?</span>
<span class="sd">        ext_name : str</span>
<span class="sd">            Name of the HDU where data are stored</span>
<span class="sd">        sex_cat_path : str</span>
<span class="sd">            Path of the existing SExtractor catalogue to mimic</span>
<span class="sd">        overwrite : bool</span>
<span class="sd">            Option to overwrite an existing catalogue</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Data not provided&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">ext_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ext_name</span> <span class="o">=</span> <span class="s1">&#39;new&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_SEx_catalogue</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">s_hdu</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sex_cat_path</span><span class="o">=</span><span class="n">sex_cat_path</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">ext_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">ext_name</span> <span class="o">=</span> <span class="s1">&#39;LDAC_OBJECTS&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">s_hdu</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">ext_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">ext_name</span> <span class="o">=</span> <span class="s1">&#39;new&#39;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">data</span><span class="p">])</span>
        <span class="n">col_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">it</span><span class="p">:</span>
            <span class="n">data_shape</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">dim</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">data_shape</span><span class="p">))</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">names</span><span class="p">[</span><span class="n">it</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">idx</span><span class="p">)]</span>
            <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_fits_col_type</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
            <span class="n">mem_size</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">shape</span> <span class="ow">in</span> <span class="n">data_shape</span><span class="p">:</span>
                    <span class="n">mem_size</span> <span class="o">*=</span> <span class="n">shape</span>
                <span class="n">data_format</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">mem_size</span><span class="si">}{</span><span class="n">data_type</span><span class="si">}</span><span class="s1">&#39;</span>
                <span class="n">col_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                    <span class="nb">format</span><span class="o">=</span><span class="n">data_format</span><span class="p">,</span>
                    <span class="n">array</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
                    <span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span>
                <span class="p">))</span>
            <span class="k">elif</span> <span class="n">data_type</span> <span class="o">==</span> <span class="s1">&#39;A&#39;</span><span class="p">:</span>
                <span class="n">mem_size</span> <span class="o">*=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="nb">len</span><span class="p">))</span>
                <span class="n">data_format</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">mem_size</span><span class="si">}{</span><span class="n">data_type</span><span class="si">}</span><span class="s1">&#39;</span>
                <span class="n">col_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                    <span class="nb">format</span><span class="o">=</span><span class="n">data_format</span><span class="p">,</span>
                    <span class="n">array</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
                    <span class="n">dim</span><span class="o">=</span><span class="nb">str</span><span class="p">((</span><span class="n">mem_size</span><span class="p">,)),</span>
                <span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data_format</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">mem_size</span><span class="si">}{</span><span class="n">data_type</span><span class="si">}</span><span class="s1">&#39;</span>
                <span class="n">col_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                    <span class="nb">format</span><span class="o">=</span><span class="n">data_format</span><span class="p">,</span>
                    <span class="n">array</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
                <span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">fits</span><span class="o">.</span><span class="n">BinTableHDU</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="n">col_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">ext_name</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="FITSCatalogue._save_from_recarray"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue._save_from_recarray">[docs]</a>    <span class="k">def</span> <span class="nf">_save_from_recarray</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">ext_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">sex_cat_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save From Record Array.</span>

<span class="sd">        Save a numpy.recarray or astropy.io.fits.fitsrec.FITS_rec into a FITS</span>
<span class="sd">        file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data : numpy.ndarray</span>
<span class="sd">            Array with the data</span>
<span class="sd">        ext_name : str</span>
<span class="sd">            Name of the HDU where data are stored</span>
<span class="sd">        sex_cat_path : str</span>
<span class="sd">            Path of the existing SExtractor catalogue to mimic</span>
<span class="sd">        overwrite : bool</span>
<span class="sd">            Option to overwrite an existing catalogue</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Data not provided&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">ext_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ext_name</span> <span class="o">=</span> <span class="s1">&#39;new&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">BinTableHDU</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">ext_name</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_SEx_catalogue</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">s_hdu</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sex_cat_path</span><span class="o">=</span><span class="n">sex_cat_path</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">ext_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">ext_name</span> <span class="o">=</span> <span class="s1">&#39;LDAC_OBJECTS&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">BinTableHDU</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">ext_name</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">s_hdu</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">ext_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">ext_name</span> <span class="o">=</span> <span class="s1">&#39;new&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_cat_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">BinTableHDU</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">ext_name</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="FITSCatalogue._save_image"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue._save_image">[docs]</a>    <span class="k">def</span> <span class="nf">_save_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save Image.</span>

<span class="sd">        Save an image into a FITS file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data : numpy.ndarray</span>
<span class="sd">            Array with the data</span>
<span class="sd">        header : astropy.io.fits.header</span>
<span class="sd">            FITS header</span>
<span class="sd">        overwrite : bool</span>
<span class="sd">            Option to overwrite an existing catalogue</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">fits</span><span class="o">.</span><span class="n">PrimaryHDU</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">,</span>
                <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Data or names not provided&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="FITSCatalogue.Column"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.FITSCatalogue.Column">[docs]</a>    <span class="k">class</span> <span class="nc">Column</span><span class="p">(</span><span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">Column</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Column.</span>

<span class="sd">        Represents a column in the catalogue.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Name name of the column</span>
<span class="sd">        format : str</span>
<span class="sd">            Python format of the column</span>
<span class="sd">        comment : str</span>
<span class="sd">            Comment strin</span>
<span class="sd">        data : numpy.ndarray</span>
<span class="sd">            Associated column data</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
            <span class="n">BaseCatalogue</span><span class="o">.</span><span class="n">Column</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>

            <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;D&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_format</span> <span class="o">=</span> <span class="nb">format</span>

            <span class="k">if</span> <span class="n">comment</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">comment</span> <span class="o">=</span> <span class="n">name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_comment</span> <span class="o">=</span> <span class="n">comment</span>

            <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">data</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">info</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_cat_col</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="k">return</span> <span class="n">info</span>

        <span class="nd">@property</span>
        <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Set Name.</span>

<span class="sd">            Get the name of the column.</span>

<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

        <span class="nd">@property</span>
        <span class="k">def</span> <span class="nf">format</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Format.</span>

<span class="sd">            Get the format of the column.</span>

<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format</span>

        <span class="nd">@property</span>
        <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Comment.</span>

<span class="sd">            Get the comment string associated with the column.</span>

<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comment</span>

        <span class="nd">@property</span>
        <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Set Data.</span>

<span class="sd">            Get the data associated with the column.</span>

<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>

        <span class="nd">@name</span><span class="o">.</span><span class="n">setter</span>
        <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>

        <span class="nd">@format</span><span class="o">.</span><span class="n">setter</span>
        <span class="k">def</span> <span class="nf">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">format</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_format</span> <span class="o">=</span> <span class="nb">format</span>

        <span class="nd">@comment</span><span class="o">.</span><span class="n">setter</span>
        <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">comment</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_comment</span> <span class="o">=</span> <span class="n">comment</span>

        <span class="nd">@data</span><span class="o">.</span><span class="n">setter</span>
        <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">data</span></div></div>


<div class="viewcode-block" id="get_unit_from_fits_header"><a class="viewcode-back" href="../../../shapepipe.pipeline.file_io.html#shapepipe.pipeline.file_io.get_unit_from_fits_header">[docs]</a><span class="k">def</span> <span class="nf">get_unit_from_fits_header</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get Unit From FITS Header.</span>

<span class="sd">    Return coordinate unit corresponding to column with name ``key``.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    header : FITS header</span>
<span class="sd">        Header information</span>
<span class="sd">    key : str</span>
<span class="sd">        Column name</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    IndexError</span>
<span class="sd">        If key not in header</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    astropy.units.Unit</span>
<span class="sd">        Unit object</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Loop over column names to find key</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">idx_found</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">ttype_idx</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;TTYPE</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">ttype_idx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">header</span><span class="p">:</span>
            <span class="c1"># Reached beyond last column</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">header</span><span class="p">[</span><span class="n">ttype_idx</span><span class="p">]</span> <span class="o">==</span> <span class="n">key</span><span class="p">:</span>
                <span class="c1"># Found correct column</span>
                <span class="n">idx_found</span> <span class="o">=</span> <span class="n">idx</span>
                <span class="k">break</span>
        <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">idx_found</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Column </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="se">\&#39;</span><span class="s1"> not found in FITS header&#39;</span><span class="p">)</span>

    <span class="c1"># Extract coordinate unit string from header</span>
    <span class="n">tcunit_idx</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;TCUNI</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="k">if</span> <span class="n">tcunit_idx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">header</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;No coordinate unit found for column </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="se">\&#39;</span><span class="s1">&#39;</span>
            <span class="s1">&#39; in FITS header&#39;</span>
        <span class="p">)</span>
    <span class="n">unit_str</span> <span class="o">=</span> <span class="n">header</span><span class="p">[</span><span class="n">tcunit_idx</span><span class="p">]</span>

    <span class="c1"># Transform to Unit object</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">units</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="n">unit_str</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">u</span></div>
</pre></div>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By CosmoStat<br/>
    
        &copy; Copyright 2022, CosmoStat.<br/>
      Last updated on 12 Oct, 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>